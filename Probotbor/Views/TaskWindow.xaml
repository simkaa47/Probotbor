<Window x:Class="Probotbor.Views.TaskWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Probotbor.Views"
        xmlns:AddClass="clr-namespace:Probotbor.Views.AddClass"
        xmlns:vm="clr-namespace:Probotbor.ViewModels" xmlns:col1="clr-namespace:System.Collections;assembly=mscorlib" xmlns:sys1="clr-namespace:System;assembly=mscorlib"
        xmlns:conv="clr-namespace:Probotbor.Views"
        xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity" 
        mc:Ignorable="d"
        Title="TaskWindow" ResizeMode="NoResize" WindowStartupLocation="CenterScreen" WindowState="Maximized" Height="1080" Width="1920" WindowStyle="None" AllowsTransparency="True">

    <Window.Resources>
        <!--#region Конвертеры -->
        <conv:IndicatorVisible x:Key="visibleConverter" />
        <conv:IndicatorUnVisible x:Key="unVisibleConverter" />
        <conv:ColorConverterIndicator x:Key="colorConv"/>
        <conv:CheckSystemStatusText x:Key="systemStatusConv"/>
        <conv:CheckProbStatusText x:Key="statProbConv"/>
        <conv:CheckBunkStatusText x:Key="statBunkConv"/>
        <conv:CheckDelStatusText x:Key="statDelConv"/>
        <conv:CheckNakopStatusText x:Key="statNakopConv"/>
        <conv:TimeConverter x:Key="SecondsToTime"/>
        <conv:FindTextError x:Key="FindTextError"/>
        <!--Конвертер сложения value + parameter-->
        <conv:AddConverter x:Key="AddConverter"/>
        <!--Конвертер вычитания value - parameter-->
        <conv:SubConverter x:Key="SubConverter"/>
        <!--Конвертер деления value / parameter-->
        <conv:DivConverter x:Key="DivConverter"/>
        <!--Конвертер умножения value * parameter-->
        <conv:MulConverter x:Key="MulConverter"/>
        <conv:SomeConverter x:Key="Some"/>
        <conv:GetHeight x:Key="GetHeight"/>
        <conv:GetWidth x:Key="GetWidth"/>

        <!--Возвращает bool при сравнении value и parameter -->
        <conv:IsLess x:Key="isLess"/>
        <!--Возвращает bool при сравнении value и parameter -->
        <conv:IsGreater x:Key="isGreater"/>
        <!--Возвращает bool при сравнении value и parameter -->
        <conv:UnVisibleIfGreater x:Key="unVisibleIfGreater"/>
        <!--Возвращает Visibility.Collapsed, если value > parameter-->
        <conv:UnVisibleIfLess x:Key="unVisibleIfLess"/>
        <!--Возвращает Visibility.Collapsed, если value < parameter -->
        <conv:VisibleIfEqual x:Key="visibleIfEqual"/>
        <!--Возвращает Visibility.Visible, если value = parameter -->
        <conv:FloatToInt x:Key="FloatToIntConverter"/>
        <!--#endregion-->

        <Style TargetType="Label">
            <Setter Property="FontFamily" Value="Tahoma"  />
            <Setter Property="Foreground" Value="White"/>
        </Style>
        <Style TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Tahoma"/>
            
        </Style>
        



        <col1:ArrayList x:Key="booleans">
            <sys1:Boolean>true</sys1:Boolean>
            <sys1:Boolean>false</sys1:Boolean>
        </col1:ArrayList>
        <!--#region Общий стиль для TabControl -->
        <Style TargetType="TabControl">
            <Setter Property="FontSize"  Value="32"/>
            <Setter Property="FontFamily" Value="Tahoma"/>
        </Style>
        <!--#endregion-->

        <!--#region Шаблоны -->
        <!--Шаблон тумблера-->
        <!--#region Шаблон тумблера -->
        <ControlTemplate TargetType="Button" x:Key="Switcher">
            <Grid ToolTipService.IsEnabled="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}, Path=DataContext.CurrentUser.Level, Converter={StaticResource isEqual}, ConverterParameter=Администратор}">
                <ContentControl x:Name="content" Margin="{TemplateBinding Padding}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                Content="{TemplateBinding Content}">
                </ContentControl>
                <Image x:Name="ind"  Source="{StaticResource Switch_Off}"></Image>
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="PreviewMouseLeftButtonDown">
                        <i:InvokeCommandAction  Command="{Binding ButtonPressOnCommand}"/>
                    </i:EventTrigger>

                </i:Interaction.Triggers>
                <Grid.ToolTip>
                    <ToolTip Content="{Binding Id}" Placement="Mouse" ContentStringFormat="{}Кнопка {0}"></ToolTip>
                </Grid.ToolTip>
            </Grid>
            <ControlTemplate.Triggers>
                <DataTrigger Binding="{Binding BitValue}" Value="True">
                    <Setter TargetName="ind" Property="Source" Value="{StaticResource Switch_ON}"/>
                </DataTrigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
        <!--#endregion-->

        <!--#region Шаблон параметра с текстовым вводом для для темного фона -->
        <ControlTemplate TargetType="ListBoxItem" x:Key="ParamListBoxItem" >
            <ListBoxItem HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch">
                <Grid ToolTipService.IsEnabled="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}, Path=DataContext.CurrentUser.Level, Converter={StaticResource isEqual}, ConverterParameter=Администратор}">
                    <TextBlock Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=DataContext.Description, StringFormat={}{0}}"                                
                           FontSize="{TemplateBinding FontSize}"
                           Foreground="{TemplateBinding Foreground}"
                           FontFamily="{TemplateBinding FontFamily}"
                           HorizontalAlignment="Left"></TextBlock>
                    <TextBox   x:Name="TextInput"                             
                           FontSize="{TemplateBinding FontSize}"
                           Foreground="{TemplateBinding Foreground}"
                           FontFamily="Tahoma"                           
                           HorizontalAlignment="Right"                           
                           HorizontalContentAlignment="Center"
                           Width="120"
                           IsEnabled="{Binding WriteEnable}"
                               Text="{Binding WriteValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                        
                        <TextBox.InputBindings>
                            <KeyBinding Command="{Binding WriteParamCommand}" Key="Enter"  CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=DataContext}">

                            </KeyBinding>
                        </TextBox.InputBindings>
                    </TextBox>
                    <ContentControl x:Name="content" Margin="{TemplateBinding Padding}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                Content="{TemplateBinding Content}">
                    </ContentControl>

                    <Grid.ToolTip>
                        <ToolTip Content="{Binding Id}" Placement="Mouse" ContentStringFormat="{}Параметр {0}" ToolTipService.IsEnabled="False"></ToolTip>
                    </Grid.ToolTip>
                </Grid>
            </ListBoxItem>
            <ControlTemplate.Triggers>
                <DataTrigger Binding="{Binding WriteEnable}" Value="True">
                    <Setter TargetName="TextInput" Property="Background" Value="Black"/>
                </DataTrigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
        <!--#endregion-->

        <!--#region Шаблон параметра с текстовым вводом для для светлого фона -->
        <ControlTemplate TargetType="ListBoxItem" x:Key="ParamListBoxItemWhite" >
            <ListBoxItem HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch">
                <Grid ToolTipService.IsEnabled="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}, Path=DataContext.CurrentUser.Level, Converter={StaticResource isEqual}, ConverterParameter=Администратор}">
                    <TextBlock Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=DataContext.Description, StringFormat={}{0}}"                                
                           FontSize="{TemplateBinding FontSize}"
                           Foreground="{TemplateBinding Foreground}"
                           FontFamily="{TemplateBinding FontFamily}"
                           HorizontalAlignment="Left"></TextBlock>
                    <TextBox   x:Name="TextInput"  Text="{Binding WriteValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"                           
                           FontSize="{TemplateBinding FontSize}"
                           Foreground="{TemplateBinding Foreground}"
                           FontFamily="Tahoma"                           
                           HorizontalAlignment="Right"                           
                           HorizontalContentAlignment="Center"
                           Width="120"
                           IsEnabled="{Binding WriteEnable}">
                        <TextBox.InputBindings>
                            <KeyBinding Command="{Binding WriteParamCommand}" Key="Enter"  CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=DataContext}">

                            </KeyBinding>
                        </TextBox.InputBindings>
                    </TextBox>
                    <ContentControl x:Name="content" Margin="{TemplateBinding Padding}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                Content="{TemplateBinding Content}">
                    </ContentControl>

                    <Grid.ToolTip>
                        <ToolTip Content="{Binding Id}" Placement="Mouse" ContentStringFormat="{}Параметр {0}" ToolTipService.IsEnabled="False"></ToolTip>
                    </Grid.ToolTip>
                </Grid>
            </ListBoxItem>            
        </ControlTemplate>
        <!--#endregion-->

        <!--#region Шаблон параметра с выпадающим списком -->
        <ControlTemplate TargetType="ComboBox" x:Key="ParamCompbobox" >
            

            <Grid HorizontalAlignment="Stretch" ToolTipService.IsEnabled="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}, 
                Path=DataContext.CurrentUser.Level, Converter={StaticResource isEqual}, ConverterParameter=Администратор}">
                <TextBlock Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=DataContext.Description, StringFormat={}{0}}" 
                           FontSize="{TemplateBinding FontSize}"
                           Foreground="{TemplateBinding Foreground}"
                           FontFamily="{TemplateBinding FontFamily}"
                           HorizontalAlignment="Left"></TextBlock>
                <ComboBox   x:Name="TextInput"  SelectedIndex="{Binding WriteValue, Converter={StaticResource FloatToIntConverter}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                           FontSize="{TemplateBinding FontSize}"
                           Foreground="{TemplateBinding Foreground}"
                           FontFamily="Tahoma"
                           HorizontalAlignment="Right"                           
                           HorizontalContentAlignment="Center"
                           Width="120"
                           ItemsSource="{TemplateBinding ItemsSource}"
                           IsEnabled="{Binding WriteEnable}">
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="SelectionChanged" >
                            <i:InvokeCommandAction Command="{Binding WriteParamCommand}">

                            </i:InvokeCommandAction>
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                </ComboBox>
                <ContentControl x:Name="content" Margin="{TemplateBinding Padding}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}">
                </ContentControl>
                <Grid.ToolTip>
                    <ToolTip Content="{Binding Id}" Placement="Mouse" ContentStringFormat="{}Параметр {0}" ToolTipService.IsEnabled="False"></ToolTip>
                </Grid.ToolTip>
            </Grid>
        </ControlTemplate>
        <!--#endregion-->

        <!--#region Шаблон кнопки -->
        <ControlTemplate x:Key="UserButton" TargetType="ButtonBase">
            <Grid >
                <Button x:Name="border" Foreground="White" Height="{TemplateBinding Height}" Width="{TemplateBinding Width}"   
                    BorderThickness="4"  BorderBrush="White"   Background="{Binding BitValue, Converter={StaticResource colorConv}}" >

                    <ContentControl x:Name="content" Margin="{TemplateBinding Padding}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                Content="{TemplateBinding Content}">
                    </ContentControl>
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="PreviewMouseLeftButtonDown">
                            <i:InvokeCommandAction  Command="{Binding ButtonPressOnCommand}"/>
                        </i:EventTrigger>
                        <i:EventTrigger EventName="Click">
                            <i:InvokeCommandAction Command="{Binding ButtonPressOffCommand}"/>
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                    <Button.ToolTip>
                        <ToolTip Content="{Binding Id}" Placement="Mouse" ContentStringFormat="{}Кнопка {0}"></ToolTip>
                    </Button.ToolTip>
                </Button>
            </Grid>
            
        </ControlTemplate>
        <!--#endregion-->
        
        <!--#region Шаблон статуса -->
        <ControlTemplate TargetType="ListBoxItem" x:Key="Status">
            <Grid ToolTipService.IsEnabled="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window},
                Path=DataContext.CurrentUser.Level, Converter={StaticResource isEqual}, ConverterParameter=Администратор}" >
                
                <Border  x:Name="border1" Margin="10" BorderThickness="4" BorderBrush="#FF4D4848" 
                         CornerRadius="{Binding ElementName=border1, Path=ActualHeight, Converter={StaticResource DivConverter}, ConverterParameter=2}" 
                         Background="#FF4D4848" Width="{TemplateBinding Width}">
                    <StackPanel Orientation="Horizontal">
                        <Border x:Name="border2" Background="Black" MinWidth="300" CornerRadius="{Binding ElementName=border2, Path=ActualHeight, Converter={StaticResource DivConverter}, ConverterParameter=2}">
                            <Label  Content="{Binding Description}" FontFamily="Calibry" Margin="1" FontSize="15" ></Label>
                        </Border>                        
                        <TextBlock Margin="5"  x:Name="StatusText"  VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="20"                             
                           Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Tag}" TextWrapping="Wrap"
                           Foreground="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Tag, Converter={StaticResource FindTextError}, ConverterParameter=#FFFFFFFF}">
                        </TextBlock>
                    </StackPanel>
                    
                </Border>
                
                <ContentControl x:Name="content" Margin="{TemplateBinding Padding}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                Content="{TemplateBinding Content}">
                </ContentControl>
                <Grid.ToolTip>
                    <ToolTip Content="{Binding Id}" Placement="Mouse" ContentStringFormat="{}Параметр {0}" ToolTipService.IsEnabled="False"></ToolTip>
                </Grid.ToolTip>
            </Grid>
            
        </ControlTemplate>
        <!--#endregion-->

        <!--#region Шаблон лампы-индикатора -->
        <ControlTemplate TargetType="UserControl" x:Key="StandIndicator">
            <Grid ToolTipService.IsEnabled="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}, Path=DataContext.CurrentUser.Level, Converter={StaticResource isEqual}, ConverterParameter=Администратор}">
                <Image x:Name="ind" Source="Pictures\LampOff.png" Stretch="Uniform"   Width="{TemplateBinding Width}" Height="{TemplateBinding Width}" ></Image>
                <ContentControl x:Name="content" Margin="{TemplateBinding Padding}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                Content="{TemplateBinding Content}">
                </ContentControl>
                <Grid.ToolTip>
                    <ToolTip Content="{Binding Id}" Placement="Mouse" ContentStringFormat="{}Индикатор {0}" ToolTipService.IsEnabled="False"></ToolTip>
                </Grid.ToolTip>
            </Grid>
            <ControlTemplate.Triggers>
                <DataTrigger Binding="{Binding BitValue}" Value="True">
                    <Setter TargetName="ind" Property="Source" Value="Pictures\LampOn.png"/>
                </DataTrigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
        <!--#endregion-->


        <!--#region Шаблон текстового индикатора -->
        <ControlTemplate TargetType="ComboBox" x:Key="StateCompobox">
            <Border  BorderThickness="4" BorderBrush="White" Height="{TemplateBinding Height}"  CornerRadius="4"  >
                <Grid ToolTipService.IsEnabled="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window},
                    Path=DataContext.CurrentUser.Level, Converter={StaticResource isEqual}, ConverterParameter=Администратор}">
                    <Label Content="{Binding Description}"  FontSize="14" ></Label>
                    <ComboBox Name="compobox"  SelectedIndex="{Binding ParamValue, Converter={StaticResource FloatToIntConverter}}" 
                                         Visibility="Hidden" ItemsSource="{TemplateBinding ItemsSource}" IsEnabled="False" ></ComboBox>
                    <TextBlock Text="{Binding ElementName=compobox, Path=Text}" TextWrapping="Wrap" Foreground="{Binding ElementName=compobox, Path=Text, Converter={StaticResource FindTextError}}" 
                               FontSize="20" VerticalAlignment="Center" HorizontalAlignment="Center"></TextBlock>
                    <ContentControl x:Name="content" Margin="{TemplateBinding Padding}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}">
                    </ContentControl>
                    <Grid.ToolTip>
                        <ToolTip Content="{Binding Id}" Placement="Mouse" ContentStringFormat="{}Параметр {0}" ToolTipService.IsEnabled="False"></ToolTip>
                    </Grid.ToolTip>
                </Grid>
            </Border>
        </ControlTemplate>
        <!--#endregion-->

        <!--#region Шаблон текстового индикатора -->
        <ControlTemplate TargetType="ListBoxItem" x:Key="TextIndicator">
            <Grid ToolTipService.IsEnabled="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window},
                    Path=DataContext.CurrentUser.Level, Converter={StaticResource isEqual}, ConverterParameter=Администратор}">
                <Border x:Name="border1" Margin="10" BorderThickness="4" BorderBrush="#FF4D4848" 
                         CornerRadius="{Binding ElementName=border1, Path=ActualHeight, Converter={StaticResource DivConverter}, ConverterParameter=2}" 
                         Background="#FF4D4848" Width="{TemplateBinding Width}">
                    <StackPanel Orientation="Horizontal">
                        <Border x:Name="border2" Background="Black" MinWidth="300" CornerRadius="{Binding ElementName=border2, Path=ActualHeight, Converter={StaticResource DivConverter}, ConverterParameter=2}" >
                            <Label  Content="{Binding Description}" FontFamily="Calibry" Margin="1" FontSize="15" ></Label>
                        </Border>
                        <ComboBox Name="compobox" Text="НЕТ СВЯЗИ С ПЛК"  SelectedIndex="{Binding ParamValue, Converter={StaticResource FloatToIntConverter}}" 
                                         Visibility="Collapsed" ItemsSource="{Binding RelativeSource={RelativeSource Mode=TemplatedParent} , Path=Content }" IsEnabled="False" ></ComboBox>
                        <TextBlock Text="{Binding ElementName=compobox, Path=Text}" TextWrapping="Wrap" Foreground="{Binding ElementName=compobox, Path=Text, Converter={StaticResource FindTextError}}" 
                               FontSize="20" VerticalAlignment="Center" HorizontalAlignment="Center"></TextBlock>
                    </StackPanel>

                </Border>

                <ContentControl x:Name="content" Margin="{TemplateBinding Padding}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}">
                </ContentControl>
                <Grid.ToolTip>
                    <ToolTip Content="{Binding Id}" Placement="Mouse" ContentStringFormat="{}Параметр {0}" ToolTipService.IsEnabled="False"></ToolTip>
                </Grid.ToolTip>
            </Grid>
            <!--#endregion-->
        </ControlTemplate>
        
        <!--#endregion-->

        <!--#region Стили, определяющие видимость бункеров -->
        <Style TargetType="Control" x:Key="VisibleBun1">
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=bunType1, Path=SelectedIndex}" Value="0">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding ElementName=bunType1, Path=SelectedIndex}" Value="3">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="Control" x:Key="VisibleBun2">
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=bunType2, Path=SelectedIndex}" Value="0">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding ElementName=bunType2, Path=SelectedIndex}" Value="3">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>        
        <!--#endregion-->

        <!--#region Стили, определяющие видимость делтелей -->
        <Style TargetType="Control" x:Key="VisibleDel1">
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=DelType_1, Path=SelectedIndex}" Value="0">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding ElementName=DelType_1, Path=SelectedIndex}" Value="4">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="Control" x:Key="VisibleDel2">
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=DelType_2, Path=SelectedIndex}" Value="0">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding ElementName=DelType_2, Path=SelectedIndex}" Value="4">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="Control" x:Key="VisibleDel3">
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=DelType_3, Path=SelectedIndex}" Value="0">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding ElementName=DelType_3, Path=SelectedIndex}" Value="4">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style TargetType="Control" x:Key="VisibleDel4">
            <Style.Triggers>
                <DataTrigger Binding="{Binding ElementName=DelType_4, Path=SelectedIndex}" Value="0">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding ElementName=DelType_4, Path=SelectedIndex}" Value="4">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <!--#endregion-->

        <!--#region Стиль для вкладок -->
        <Style TargetType="{x:Type TabItem}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabItem}">
                        <Border Name="Border" MinWidth="300" BorderBrush="White"   BorderThickness="0,0,1,1" >
                            <DockPanel VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Margin="10,0,0,0">
                                <Image Source = "{Binding RelativeSource={RelativeSource Mode=TemplatedParent}, Path=Tag}" Stretch="None" />
                                <Label Name="L2" Content="{TemplateBinding Header}" HorizontalAlignment="Left" VerticalAlignment="Center" ></Label>
                            </DockPanel>
                        </Border>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="L2" Property="Foreground" Value="Aqua"/>
                                
                            </Trigger>

                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="L2" Property="Foreground" Value="Aqua"/>
                                
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!--#endregion-->

    </Window.Resources>
    
    <DockPanel Background="#FF382D2D">

        <!--#region Верхний бар -->
        <Grid DockPanel.Dock="Top" Height="150">
            <Grid.Background>
                <ImageBrush ImageSource="Pictures/HighBar.PNG"></ImageBrush>
            </Grid.Background>
            <Grid Width="1920">
                
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="860"></ColumnDefinition>
                    <ColumnDefinition Width="225"></ColumnDefinition>
                    <ColumnDefinition Width="310"></ColumnDefinition>
                    <ColumnDefinition Width="350"></ColumnDefinition>
                    <ColumnDefinition></ColumnDefinition>
                </Grid.ColumnDefinitions>
                <Grid Grid.Column="1">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="0.5*"></RowDefinition>
                        <RowDefinition></RowDefinition>
                    </Grid.RowDefinitions>
                    <Label HorizontalContentAlignment="Center" VerticalContentAlignment="Center" OpacityMask="#FFFBF4F4"  FontFamily="Siemens Logo" FontWeight="Bold" FontSize="14">Связь с ПЛК</Label>
                    <UserControl  Grid.Row="1"  Margin="8,0,0,20" BorderBrush="Black" >
                        <Grid>
                            <Image Source="{StaticResource PlcOff}" Visibility = "{Binding Connected, Converter = {StaticResource unVisibleConverter}}"/>
                            <Image Source="{StaticResource PlcOn}" Visibility = "{Binding Connected, Converter = {StaticResource visibleConverter}}"/>
                        </Grid>
                    </UserControl>

                </Grid>

                <!--#region Панель соообщений -->
                <Grid Grid.Column="0" Margin="270,0,0,10">
                        <Grid.Resources>
                        <Style TargetType="RowDefinition" x:Key="ErrRow">
                            <Setter Property="Height" Value="*"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ElementName=ErrPanel, Path=Visibility}" Value="Collapsed">
                                    <Setter Property="Height" Value="0"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                        <Style TargetType="RowDefinition" x:Key="FillRow">
                            <Setter Property="Height" Value="*"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ElementName=FillCanisterPanel, Path=Visibility}" Value="Collapsed">
                                    <Setter Property="Height" Value="0"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                        </Grid.Resources>

                        <Grid.RowDefinitions>
                        <RowDefinition Style="{StaticResource ErrRow }" ></RowDefinition>
                        <RowDefinition Style="{StaticResource FillRow}" ></RowDefinition>
                    </Grid.RowDefinitions>
                    <!--#region Индикация ошибки -->
                    <DockPanel x:Name="ErrPanel" Margin="0,8,0,0"  DataContext="{Binding IndicatorConfigs[0]}" Visibility="{Binding BitValue, Converter={StaticResource visibleIfEqual}, ConverterParameter=True}">
                        <Image Source="{StaticResource Warning}">
                            <Image.Style>
                                <Style>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding BitValue}" Value="True">
                                            <DataTrigger.EnterActions>
                                                <BeginStoryboard  Name="Animation">
                                                    <Storyboard>
                                                        <DoubleAnimation  Storyboard.TargetProperty="Opacity" Duration="0:0:0.3" From="1" To="0"  RepeatBehavior="Forever" AutoReverse="True"></DoubleAnimation>
                                                    </Storyboard>
                                                </BeginStoryboard>

                                            </DataTrigger.EnterActions>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding BitValue}" Value="False">
                                            <DataTrigger.EnterActions>
                                                <RemoveStoryboard BeginStoryboardName="Animation"/>
                                            </DataTrigger.EnterActions>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Image.Style>
                        </Image>
                        <TextBlock Grid.Row="0" Name="TexBltColorCh" Text="{Binding Description}" FontSize="20" Foreground="Tomato" VerticalAlignment="Center"/>
                    </DockPanel>
                    <!--#endregion-->

                    <!--#region Индикатор заполненных канистр -->
                    <DockPanel Name="FillCanisterPanel" Grid.Row="1" DataContext="{Binding IndicatorConfigs[1]}" Visibility="{Binding BitValue, Converter={StaticResource visibleIfEqual}, ConverterParameter=True}">
                        <Viewbox >
                            <TextBlock Text="{Binding Description}" Background="Yellow"></TextBlock>
                        </Viewbox>
                    </DockPanel>
                    <!--#endregion-->
                </Grid>
                <!--#endregion-->

                <!--#region Кнопка "Сброс" -->
                <Button Template="{StaticResource UserButton}" Grid.Column="2" Margin="35,10,0,10" Height="Auto" DataContext="{Binding ButtonConfigs[2]}">
                    <DockPanel>
                        <Image Source="Pictures/reset.png" Stretch="None"/>
                        <TextBlock Text="{Binding Description}" TextWrapping="WrapWithOverflow" HorizontalAlignment="Center" VerticalAlignment="Center"></TextBlock>
                    </DockPanel>
                </Button>
                <!--#endregion-->


                <!--#region Индикация времени и выход из логина -->
                <UniformGrid Grid.Column="3" Rows="2" Margin="0,0,0,0">
                    <TextBlock Text="{Binding CurTime}" HorizontalAlignment="Center" FontSize="24" VerticalAlignment="Center" Height="Auto" Foreground="#FFF4F4F9" Background="#19000000" Margin="0,20,0,0"  />
                    <Button x:Name="changeUserBtn"  BorderThickness="1" BorderBrush="Black" Content="{Binding Username}" MouseDoubleClick="changeUserBtn_MouseDoubleClick" Margin="33,8,10,24" Height="Auto" Background="#19433E45"   />
                </UniformGrid>
                <!--#endregion-->

                <!--#region Кнопка "Выход" из приложения -->
                <Button Grid.Column="4"   BorderThickness="1"  Command="{Binding CloseAppCommand}"    FontWeight="Normal" Background="Transparent"  
                        HorizontalAlignment="Left" VerticalAlignment="Stretch"  FontFamily="Siemens Logo" FontSize="36"  Height="Auto" Margin="10,0,0,0" Width="141" BorderBrush="#00673AB7">
                    <StackPanel>
                        <TextBlock FontSize="20" HorizontalAlignment="Center">Закрыть</TextBlock>
                        <Image Source="{StaticResource Exit}" />
                    </StackPanel>
                </Button>
                <!--#endregion-->
                
            </Grid>

        </Grid>
        <!--#endregion-->

        <!--#region Страницы навигации -->
        <TabControl TabStripPlacement="Bottom" Grid.ColumnSpan="4" Background="#FF363535" BorderBrush="#FFB0A6A6">

            <!--#region Страница "Управление" -->
            <TabItem  FontStyle="Normal" Width="300" Background="#FF363535" Header="УПРАВЛЕНИЕ" Tag="Pictures\control.png" >
                
                <Grid x:Name="ControlGrid" >
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Name="ControlGridColumn_1"  Width="*"></ColumnDefinition>
                        <ColumnDefinition Name="ControlGridColumn_2"  Width="*"></ColumnDefinition>
                        <ColumnDefinition Name="ControlGridColumn_3"  Width="*"></ColumnDefinition>
                        <ColumnDefinition Name="ControlGridColumn_4"  Width="*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="0.35*"></RowDefinition>
                        <RowDefinition Height="0.35*"></RowDefinition>
                        <RowDefinition></RowDefinition>
                        <RowDefinition></RowDefinition>
                    </Grid.RowDefinitions>
                    
                    <!--#region Кнопка "Старт отбора проб" -->
                    <Button x:Name="StartBtn" DataContext="{Binding ButtonConfigs[0]}" Grid.Column="0" Grid.Row="0" Template="{StaticResource UserButton}" Margin="10" BorderThickness="8" 
                              Height="Auto">
                        <StackPanel Orientation="Horizontal">
                            <Image Source="Pictures/start.png" />
                            <Label VerticalAlignment="Center" FontSize="24"  Content="{Binding Description}"/>
                        </StackPanel>
                    </Button>
                    <!--#endregion--> 

                    <!--#region Кнопка "Cтоп отбора проб" -->
                    <Button x:Name="StopBtn" DataContext="{Binding ButtonConfigs[1]}" Grid.Column="1" Grid.Row="0" Template="{StaticResource UserButton}" Margin="10" BorderThickness="8" 
                              Height="Auto">
                        <StackPanel Orientation="Horizontal">
                            <Image Source="Pictures/stop.png" HorizontalAlignment="Left" />
                            <Label VerticalAlignment="Center" FontSize="24"  Content="{Binding Description}"/>
                        </StackPanel>
                    </Button>
                    <!--#endregion--> 

                    <!--#region Панель с динамическими элементами и параметрами, которых может и не быть-->
                    <DockPanel Grid.Column="2" Grid.ColumnSpan="2" Grid.RowSpan="4"  >
                        <ListBox x:Name="count" DockPanel.Dock="Top" Background="Gray">
                            <!--#region Статус системы -->
                            <ListBoxItem Name="SysStatus" Grid.Row="0" Grid.Column="1"  Tag="{Binding ParamValue, Converter={StaticResource systemStatusConv}}"  
                                 DataContext="{Binding DataCells[0]}" Template="{StaticResource Status}"></ListBoxItem>
                            <!--#endregion-->
                            <ListBoxItem Template="{StaticResource TextIndicator}"  DataContext="{Binding DataCells[0]}" Content="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=DataContext.SysStatuses.Status}"></ListBoxItem>
                            <!--#region Статус пробоотборника -->
                            <ListBoxItem  Tag="{Binding ParamValue, Converter={StaticResource statProbConv}}"  DataContext="{Binding DataCells[1]}"  Template="{StaticResource Status}"></ListBoxItem>
                            <!--#endregion-->
                            <!--#region Статус проботборника 2  -->
                            <ListBoxItem    Tag="{Binding ParamValue, Converter={StaticResource statProbConv}}"  DataContext="{Binding DataCells[2]}" Template="{StaticResource Status}" Visibility="{Binding ElementName=ProbInd_2, Path=Visibility}"></ListBoxItem>
                            <!--#endregion-->
                            <!--#region Статус бункера 1 -->
                            <ListBoxItem   Tag="{Binding ParamValue, Converter={StaticResource statBunkConv}}"  DataContext="{Binding DataCells[75]}" Template="{StaticResource Status}" 
                                           Visibility="{Binding ElementName=bunType1, Path=SelectedIndex, Converter={StaticResource unVisibleIfLess}, ConverterParameter=1}"></ListBoxItem>
                            <!--#endregion-->
                            <!--#region Статус бункера 2 -->
                            <ListBoxItem MinWidth="478.5" Tag="{Binding ParamValue, Converter={StaticResource statBunkConv}}"  DataContext="{Binding DataCells[76]}" Template="{StaticResource Status}" 
                                          Visibility="{Binding ElementName=bunType2, Path=SelectedIndex, Converter={StaticResource unVisibleIfLess}, ConverterParameter=1}"></ListBoxItem>
                            <!--#endregion-->
                            <!--#region Статус делителя 1 -->
                            <ListBoxItem  Tag="{Binding ParamValue, Converter={StaticResource statDelConv}}"  DataContext="{Binding DataCells[64]}"  Template="{StaticResource Status}" 
                                         Style="{StaticResource VisibleDel1}"></ListBoxItem>
                            <!--#endregion-->
                            <!--#region Статус делителя 2 -->
                            <ListViewItem   Tag="{Binding ParamValue, Converter={StaticResource statDelConv}}"  DataContext="{Binding DataCells[65]}"  Template="{StaticResource Status}" 
                                         Style="{StaticResource VisibleDel2}"></ListViewItem>
                            <!--#endregion-->
                            <!--#region Статус делителя 3 -->
                            <ListBoxItem  Tag="{Binding ParamValue, Converter={StaticResource statDelConv}}"  DataContext="{Binding DataCells[66]}"  Template="{StaticResource Status}" 
                                         Style="{StaticResource VisibleDel3}"></ListBoxItem>
                            <!--#endregion-->
                            <!--#region Статус делителя 4 -->
                            <ListBoxItem   Tag="{Binding ParamValue, Converter={StaticResource statDelConv}}"  DataContext="{Binding DataCells[67]}"  Template="{StaticResource Status}" 
                                         Style="{StaticResource VisibleDel4}"></ListBoxItem>
                            <!--#endregion-->
                            <!--#region Статус накопителя -->
                            <ListBoxItem  Tag="{Binding ParamValue, Converter={StaticResource statNakopConv}}"  DataContext="{Binding DataCells[5]}"  Template="{StaticResource Status}" Visibility="{Binding ElementName=NakopitelEnable,Path=IsChecked, Converter={StaticResource visibleConverter}}"></ListBoxItem>
                            <!--#endregion-->
                        </ListBox>
                        
                        <!--отображение текущих параметров системы-->
                        <ListBox DockPanel.Dock="Bottom" Margin="4" FontFamily="Calibry" Foreground="#DDD1C8C8" Background="#FF363535" FontSize="20">
                            
                            <ListBoxItem DataContext="{Binding DataCells[6]}" HorizontalContentAlignment="Stretch">
                                <Grid HorizontalAlignment="Stretch">
                                    <TextBlock Text="{Binding Description}" ></TextBlock>
                                    <TextBox Text="{Binding ParamValue, Converter={StaticResource SecondsToTime}}" HorizontalContentAlignment="Right" IsEnabled="False" ></TextBox>
                                </Grid>
                            </ListBoxItem>
                            <ListBoxItem Template="{StaticResource ParamListBoxItem}"  HorizontalContentAlignment="Stretch" DataContext="{Binding DataCells[7]}"></ListBoxItem>
                            <ListBoxItem Template="{StaticResource ParamListBoxItem}" Visibility="{Binding ElementName=BunkerEnable,Path=IsChecked,Converter={StaticResource visibleConverter}}" HorizontalContentAlignment="Stretch" DataContext="{Binding DataCells[8]}"></ListBoxItem>
                            <ListBoxItem Template="{StaticResource ParamListBoxItem}" Visibility="{Binding ElementName=BunkerEnable,Path=IsChecked,Converter={StaticResource visibleConverter}}" HorizontalContentAlignment="Stretch" DataContext="{Binding DataCells[9]}"></ListBoxItem>
                            <ListBoxItem Template="{StaticResource ParamListBoxItem}" Visibility="{Binding ElementName=DrobEnable,Path=IsChecked,Converter={StaticResource visibleConverter}}" HorizontalContentAlignment="Stretch" DataContext="{Binding DataCells[10]}"></ListBoxItem>
                            <ListBoxItem Template="{StaticResource ParamListBoxItem}" Visibility="{Binding ElementName=NakopitelEnable,Path=IsChecked,Converter={StaticResource visibleConverter}}" HorizontalContentAlignment="Stretch" DataContext="{Binding DataCells[11]}"></ListBoxItem>
                            <ListBoxItem Template="{StaticResource ParamListBoxItem}"  HorizontalContentAlignment="Stretch" DataContext="{Binding DataCells[12]}"></ListBoxItem>
                            <ListBoxItem HorizontalContentAlignment="Stretch" DataContext="{Binding ButtonConfigs[8]}" >
                                <Grid>
                                    <TextBlock Text="{Binding Description}" ></TextBlock>
                                    <Button Template="{StaticResource Switcher}"  HorizontalAlignment="Right"></Button>
                                </Grid>
                            </ListBoxItem>                            
                        </ListBox>
                    </DockPanel>
                    <!--#endregion-->
                    
                    <!--#region Индикация узлов в картинках -->

                    <Border Name="ViewBorder" Grid.Row="1" Grid.ColumnSpan="2" Grid.RowSpan="3" BorderThickness="1" BorderBrush="White"   Margin="5">
                        <WrapPanel ItemHeight="{Binding ElementName=count, Path=Items.Count, Converter={StaticResource GetHeight}, ConverterParameter=740}" 
                                   
                                   HorizontalAlignment="Center" VerticalAlignment="Center">
                            <UserControl Template="{StaticResource ProbOtborIndicator}" DataContext="{Binding DataCells[1]}"></UserControl >
                            <UserControl Name="ProbInd_2" Template="{StaticResource ProbOtborIndicator}" DataContext="{Binding DataCells[2]}"
                                         Visibility="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}, Path=DataContext.DataCells[13].ParamValue, Converter={StaticResource unVisibleIfLess}, ConverterParameter=2}"></UserControl>
                            <UserControl Template="{StaticResource bunkIndicator}" DataContext="{Binding DataCells[75]}" Style="{StaticResource VisibleBun1}"></UserControl>
                            <UserControl Template="{StaticResource bunkIndicator}" DataContext="{Binding DataCells[76]}" Style="{StaticResource VisibleBun2}"></UserControl>
                            <UserControl Template="{StaticResource DelIndicator}" DataContext="{Binding DataCells[64]}" Style="{StaticResource VisibleDel1}"></UserControl>
                            <UserControl Template="{StaticResource DelIndicator}" DataContext="{Binding DataCells[65]}" Style="{StaticResource VisibleDel2}"></UserControl>
                            <UserControl Template="{StaticResource DelIndicator}" DataContext="{Binding DataCells[66]}" Style="{StaticResource VisibleDel3}"></UserControl>
                            <UserControl Template="{StaticResource DelIndicator}" DataContext="{Binding DataCells[67]}" Style="{StaticResource VisibleDel4}"></UserControl>
                            <UserControl Template="{StaticResource NakopIndicator}" DataContext="{Binding DataCells[5]}" Visibility="{Binding ElementName=NakopitelEnable, Path=IsChecked, Converter={StaticResource BooleanToVisibilityConverter}}"></UserControl>
                        </WrapPanel>
                    </Border>



                    <!--#endregion-->
                    
                </Grid>
            </TabItem>
            <!--#endregion-->

            <!--#region Страница "Параметры" -->
            <TabItem  Background="#FF363535" Width="300" Tag="Pictures/molot.png" Header="ПАРАМЕТРЫ">

                <!--Шаблон стиля для ListBoxItem параметров-->
                <TabItem.Resources>
                    <Style x:Key="VisibleParam" TargetType="ListBoxItem">
                        <Setter Property="Visibility" Value="Collapsed"></Setter>
                        <Style.Triggers>
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Focusable}" Value="true"/>
                                    <Condition Binding ="{Binding RelativeSource={RelativeSource AncestorType=Window, Mode=FindAncestor}, Path=DataContext.CurrentUser.Level}" Value="Администратор"/>
                                </MultiDataTrigger.Conditions>
                                <Setter Property="Visibility" Value="Visible"/>
                            </MultiDataTrigger>
                        </Style.Triggers>
                    </Style>
                </TabItem.Resources>

                <TabControl Background="#FF363535" BorderBrush="#FFB0A6A6" TabStripPlacement="Left" HorizontalContentAlignment="Left">

                    <!--#region Параметры проботборников -->
                    <TabItem Tag="Pictures/prob.png" Header="ПРОБООТБОРНИК">
                        <Grid >
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition></ColumnDefinition>
                                <ColumnDefinition></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="0.75*"></RowDefinition>
                                <RowDefinition></RowDefinition>
                            </Grid.RowDefinitions>
                            
                            <!--#region Статусы и параметры -->
                            <DockPanel Grid.Column="1">

                                <!--#region Статусы пробоотборников -->
                                <ListBox DockPanel.Dock="Top" Background="Gray">
                                    <!--#region Статус пробоборника 1 -->
                                    <ListBoxItem  Template="{StaticResource Status}" Tag="{Binding ParamValue, Converter={StaticResource statProbConv}}"  
                                             DataContext="{Binding DataCells[1]}"/>
                                    <!--#endregion-->
                                    <!--#region Статус пробоборника 2 -->
                                    <ListBoxItem   Template="{StaticResource Status}" Tag="{Binding ParamValue, Converter={StaticResource statProbConv}}"  DataContext="{Binding DataCells[2]}"                  
                                             Visibility="{Binding ElementName=ProbInd_2, Path=Visibility}"/>
                                    <!--#endregion-->
                                </ListBox>
                                <!--#endregion-->

                                <!--#region Параметры пробоотборника -->
                                <ListBox DockPanel.Dock="Bottom" x:Name="ProbParameters" FontFamily="Tahoma" Foreground="#DDD1C8C8" Background="#FF363535" FontSize="20" HorizontalContentAlignment="Stretch" >

                                    <ListBoxItem Template="{StaticResource ParamListBoxItem}" DataContext="{Binding DataCells[20]}"></ListBoxItem>
                                    <ListBoxItem Template="{StaticResource ParamListBoxItem}" DataContext="{Binding DataCells[21]}"  Visibility="{Binding ElementName = ProbInd_2, Path=Visibility, UpdateSourceTrigger=PropertyChanged}"></ListBoxItem>
                                    <ListBoxItem  Template="{StaticResource ParamListBoxItem}" DataContext="{Binding DataCells[22]}" Style="{StaticResource VisibleParam}"></ListBoxItem>
                                    <ListBoxItem  Template="{StaticResource ParamListBoxItem}" DataContext="{Binding DataCells[23]}" Style="{StaticResource VisibleParam}" 
                                              Focusable="{Binding RelativeSource={RelativeSource AncestorType=Window, Mode=FindAncestor}, Path=DataContext.DataCells[13].ParamValue, Converter={StaticResource isEqual}, ConverterParameter=2}"></ListBoxItem>

                                </ListBox>
                                <!--#endregion-->

                            </DockPanel>
                            <!--#endregion-->
                            
                            <!--#region Панель управления и индикации для проботоборника -->
                            <Grid Grid.Row="0" Grid.Column="0">
                                <Grid.Resources>
                                    <Style x:Key="column_2" TargetType="ColumnDefinition">
                                        <Setter Property="Width" Value="*"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName = ProbInd_2, Path=Visibility}" Value="Collapsed">
                                                <Setter Property="Width" Value="0"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Grid.Resources>
                                <!--#region Управление шириной столбца в зависимости от конфигурации -->

                                <Grid.RowDefinitions>
                                    <RowDefinition Height="0.3*"></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>

                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition></ColumnDefinition>
                                    <ColumnDefinition Style="{StaticResource column_2}"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <!--#endregion-->
                                
                                <!--#region Управление проботборником 1 -->
                                <Label Content="Управление проботборником 1" Foreground="#DDD1C8C8" FontSize="14"></Label>

                                <!--#region Кнопки управления -->
                                <Grid Grid.Column="0" Grid.Row="1">
                                    <Grid.Resources>
                                        <Style x:Key="NeedReturnVisisbility1" TargetType="ColumnDefinition">
                                            <Setter Property="Width" Value="*"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IndicatorConfigs[4].BitValue}" Value="False"  >
                                                    <Setter Property="Width" Value="0"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Resources>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition></ColumnDefinition>
                                        <ColumnDefinition Style="{StaticResource NeedReturnVisisbility1}"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <!--#region Отобрать еденичную пробу -->
                                    <Button  Height="Auto"  Template="{StaticResource UserButton}"   DataContext="{Binding ButtonConfigs[6]}"   
                                    BorderBrush="#FF534949"   Background="{Binding BitValue, Converter={StaticResource colorConv}}" FontWeight="Bold"  >
                                        <Grid HorizontalAlignment="Stretch">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="0.3*"></ColumnDefinition>
                                                <ColumnDefinition Width="*"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <Image Source="Pictures/startProb.png"  HorizontalAlignment="Left" />
                                            <TextBlock Grid.Column="1" FontSize="16"  Text="{Binding Description}" TextWrapping="WrapWithOverflow" VerticalAlignment="Center"  />
                                        </Grid>
                                    </Button>
                                    <!--#endregion-->

                                    <!--#region Возврат ковша в исходное состояние -->
                                    <Button Grid.Column="1"  Template="{StaticResource UserButton}" DataContext="{Binding ButtonConfigs[9]}" 
                                    Visibility="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}, Path=DataContext.IndicatorConfigs[4].BitValue, Converter={StaticResource visibleConverter}}"
                                    BorderBrush="#FF534949"  Height="Auto" Background="{Binding BitValue, Converter={StaticResource colorConv}}" FontWeight="Bold" >
                                        <TextBlock  FontSize="16"  Text="{Binding Description}" TextWrapping="WrapWithOverflow" VerticalAlignment="Center"/>
                                    </Button>
                                    <!--#endregion-->

                                </Grid>
                                <DockPanel Grid.Column="0" Grid.Row="1" Name="DockProb1">


                                </DockPanel>
                                <!--#endregion-->
                                <!--#region Индикация датчиков -->
                                <StackPanel Grid.Row="2" VerticalAlignment="Center"   HorizontalAlignment="Left">
                                    <!--Датчик исходного положения ковша пробооборника 1-->
                                    <StackPanel Orientation="Horizontal" DataContext="{Binding IndicatorConfigs[6]}">
                                        <UserControl Template="{StaticResource StandIndicator}" Height="40" Width="40" ></UserControl>
                                        <Label Content="{Binding Description }"  Foreground="#DDD1C8C8" FontSize="14"></Label>
                                    </StackPanel>
                                    <!--Датчик рабочего положения ковша пробооборника 1-->
                                    <StackPanel  Orientation="Horizontal" DataContext="{Binding IndicatorConfigs[7]}" 
                                                 Visibility="{ Binding RelativeSource={RelativeSource AncestorType=Window, Mode=FindAncestor}, Path=DataContext.DataCells[25].ParamValue, Converter={StaticResource unVisibleConverter}, ConverterParameter=2}" >
                                        <UserControl Template="{StaticResource StandIndicator}" Height="40" Width="40" ></UserControl>
                                        <Label Content="{Binding Description }"  Foreground="#DDD1C8C8" FontSize="14"></Label>
                                    </StackPanel>
                                </StackPanel>
                                <!--#endregion-->

                                <!--#endregion-->

                                <!--#region Управление проботборником 2 -->
                                <Label Content="Управление проботборником 2" Grid.Column="1" Foreground="#DDD1C8C8" FontSize="14" Visibility="{Binding ElementName=ProbInd_2, Path=Visibility, UpdateSourceTrigger=PropertyChanged}" ></Label>

                                <!--#region Кнопки управления -->
                                <Grid Grid.Column="1" Grid.Row="1">
                                    <Grid.Resources>
                                        <Style x:Key="NeedReturnVisisbility2" TargetType="ColumnDefinition">
                                            <Setter Property="Width" Value="*"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IndicatorConfigs[5].BitValue}" Value="False"  >
                                                    <Setter Property="Width" Value="0"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Grid.Resources>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition></ColumnDefinition>
                                        <ColumnDefinition Style="{StaticResource NeedReturnVisisbility2}"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <!--#region Отобрать еденичную пробу -->
                                    <Button Template="{StaticResource UserButton}"  DataContext="{Binding ButtonConfigs[7]}"
                                    BorderBrush="#FF534949"  Height="Auto" Background="{Binding BitValue, Converter={StaticResource colorConv}}" FontWeight="Bold"  >
                                        <Grid HorizontalAlignment="Stretch">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="0.3*"></ColumnDefinition>
                                                <ColumnDefinition Width="*"></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <Image Source="Pictures/startProb.png"  HorizontalAlignment="Left" />
                                            <TextBlock Grid.Column="1" FontSize="16"  Text="{Binding Description}" TextWrapping="WrapWithOverflow" VerticalAlignment="Center"/>
                                        </Grid>
                                    </Button>
                                    <!--#endregion-->

                                    <!--#region Возврат ковша в исходное состояние -->
                                    <Button Grid.Column="1" Template="{StaticResource UserButton}"  DataContext="{Binding ButtonConfigs[10]}" 
                                    Visibility="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window}, Path=DataContext.IndicatorConfigs[5].BitValue, Converter={StaticResource visibleConverter}}"
                                    BorderBrush="#FF534949"  Height="Auto" Background="{Binding BitValue, Converter={StaticResource colorConv}}" FontWeight="Bold" >
                                        <TextBlock Grid.Column="1" FontSize="14"  Text="{Binding Description}" TextWrapping="WrapWithOverflow" VerticalAlignment="Center"/>
                                    </Button>
                                    <!--#endregion-->

                                </Grid>
                                <!--#endregion-->



                                <!--#region Индикация датчиков -->
                                <StackPanel Grid.Row="2" Grid.Column="1" VerticalAlignment="Center"   HorizontalAlignment="Left" Visibility="{Binding ElementName=ProbInd_2, Path=Visibility, UpdateSourceTrigger=PropertyChanged}">
                                    <!--Датчик исходного положения ковша пробооборника 2-->
                                    <StackPanel Orientation="Horizontal" DataContext="{Binding IndicatorConfigs[8]}">
                                        <UserControl Template="{StaticResource StandIndicator}" Height="40" Width="40" ></UserControl>
                                        <Label Content="{Binding Description }"  Foreground="#DDD1C8C8" FontSize="14"></Label>
                                    </StackPanel>
                                    <!--Датчик рабочего положения ковша пробооборника 2-->
                                    <StackPanel  Orientation="Horizontal" DataContext="{Binding IndicatorConfigs[9]}"
                                                 Visibility="{ Binding RelativeSource={RelativeSource AncestorType=Window, Mode=FindAncestor}, Path=DataContext.DataCells[25].ParamValue, Converter={StaticResource unVisibleConverter}, ConverterParameter=2}">
                                        <UserControl Template="{StaticResource StandIndicator}" Height="40" Width="40" ></UserControl>
                                        <Label Content="{Binding Description }"  Foreground="#DDD1C8C8" FontSize="14"></Label>
                                    </StackPanel>
                                </StackPanel>
                                <!--#endregion-->
                                <!--#endregion-->
                            </Grid>
                            <!--#endregion-->

                            <!--#region Визуализация -->
                            <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Center">
                                <UserControl Template="{StaticResource ProbOtborIndicator}" DataContext="{Binding DataCells[1]}"></UserControl>
                                <UserControl Template="{StaticResource ProbOtborIndicator}" DataContext="{Binding DataCells[2]}" Visibility="{Binding ElementName=ProbInd_2, Path=Visibility}"></UserControl>
                            </StackPanel>
                            <!--#endregion-->
                            
                        </Grid>
                    </TabItem>
                    <!--#endregion-->

                    <!--#region Параметры бункера -->
                    <TabItem Header="БУНКЕР" Tag="Pictures/prob.png"  Visibility="{Binding ElementName=BunkerEnable, Path=IsChecked, Converter={StaticResource visibleConverter}}">

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition></ColumnDefinition>
                                <ColumnDefinition Width="0.95*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition></RowDefinition>
                                <RowDefinition></RowDefinition>
                            </Grid.RowDefinitions>
                            <!--#region Панель управления и индикации -->
                            <Grid >
                                <Grid.Resources>

                                    <!--#region Управление шириной столбца в зависимости от конфигурации -->
                                    <Style x:Key="column_1" TargetType="ColumnDefinition">
                                        <Setter Property="Width" Value="*"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName= bunType1, Path=SelectedIndex}" Value="0">
                                                <Setter Property="Width" Value="0"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                    <Style x:Key="column_2" TargetType="ColumnDefinition">
                                        <Setter Property="Width" Value="*"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding ElementName= bunType2, Path=SelectedIndex}" Value="0">
                                                <Setter Property="Width" Value="0"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                    <!--#endregion-->

                                    <!--Cтиль для border-->
                                </Grid.Resources>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Style="{StaticResource column_1}" ></ColumnDefinition>
                                    <ColumnDefinition Style="{StaticResource column_2}"></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <!--#region Управление бункером 1 -->
                                <Grid Grid.Column="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition></ColumnDefinition>
                                        <ColumnDefinition></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="0.5*"></RowDefinition>
                                        <RowDefinition></RowDefinition>
                                        <RowDefinition></RowDefinition>
                                        <RowDefinition></RowDefinition>
                                        <RowDefinition></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Label Grid.ColumnSpan="2" Content="Бункер 1" FontSize="20"  VerticalAlignment="Center" HorizontalAlignment="Center"></Label>
                                    
                                    <!--#region Открыть бункер -->
                                    <Button Grid.Row="1" Template="{StaticResource UserButton}" DataContext="{Binding ButtonConfigs[22]}" Height="Auto" Visibility="{Binding ElementName=bunType1, Path=SelectedIndex, Converter={StaticResource unVisibleIfGreater}, ConverterParameter=2}" >
                                        <DockPanel>
                                            <Image Source="Pictures/open.png" Width="50"></Image>
                                            <TextBlock Text="{Binding Description}" TextWrapping="WrapWithOverflow" FontSize="20" VerticalAlignment="Center" HorizontalAlignment="Center"></TextBlock>
                                        </DockPanel>
                                    </Button>
                                    <!--#endregion-->

                                    <!--#region Закрыть бункер -->
                                    <Button Grid.Row="1" Grid.Column="1"  Template="{StaticResource UserButton}" DataContext="{Binding ButtonConfigs[23]}" Height="Auto" Visibility="{Binding ElementName=bunType1, Path=SelectedIndex, Converter={StaticResource unVisibleIfGreater}, ConverterParameter=2}" >
                                        <DockPanel>
                                            <Image Source="Pictures/close.png" Width="50"></Image>
                                            <TextBlock Text="{Binding Description}" TextWrapping="WrapWithOverflow" FontSize="20" VerticalAlignment="Center" HorizontalAlignment="Center"></TextBlock>
                                        </DockPanel>
                                    </Button>
                                    <!--#endregion-->

                                    <!--#region Индикатор "Бункер открывается" -->
                                    <DockPanel Grid.Row="3" DataContext="{Binding IndicatorConfigs[49]}" Visibility="{Binding ElementName=bunType1, Path=SelectedIndex, Converter={StaticResource unVisibleIfGreater}, ConverterParameter=2}" >
                                        <UserControl Template="{StaticResource StandIndicator}" Width="50"/>
                                        <TextBlock Text="{Binding Description}" Foreground="#DDD1C8C8"  FontSize="20" HorizontalAlignment="Left" VerticalAlignment="Center" TextWrapping="WrapWithOverflow"/>
                                    </DockPanel>
                                    <!--#endregion-->

                                    <!--#region Индикатор "Бункер закрывается" -->
                                    <DockPanel Grid.Row="4"  DataContext="{Binding IndicatorConfigs[51]}" Visibility="{Binding ElementName=bunType1, Path=SelectedIndex, Converter={StaticResource unVisibleIfGreater}, ConverterParameter=2}" >
                                        <UserControl Template="{StaticResource StandIndicator}" Width="50"/>
                                        <TextBlock Text="{Binding Description}" Foreground="#DDD1C8C8"  FontSize="20" HorizontalAlignment="Left" VerticalAlignment="Center" TextWrapping="WrapWithOverflow"/>
                                    </DockPanel>
                                    <!--#endregion-->
                                    
                                    <!--#region Включить выключить траспортер -->
                                    <Button Grid.Row="1" Grid.ColumnSpan="2" Template="{StaticResource UserButton}" DataContext="{Binding ButtonConfigs[26]}" Height="Auto"
                                            Visibility="{Binding ElementName=bunType1, Path=SelectedIndex, Converter={StaticResource visibleIfEqual}, ConverterParameter=3}">
                                        <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="20" Text="{Binding Description}"></TextBlock>
                                    </Button>
                                    <!--#endregion-->

                                    <!--#region Индикатор двигателя конвейера -->
                                    <DockPanel Grid.Row="3" DataContext="{Binding IndicatorConfigs[53]}" Visibility="{Binding ElementName=bunType1, Path=SelectedIndex, Converter={StaticResource visibleIfEqual}, ConverterParameter=3}" >
                                        <UserControl Template="{StaticResource StandIndicator}" Width="50"/>
                                        <TextBlock Text="{Binding Description}" Foreground="#DDD1C8C8"  FontSize="20" HorizontalAlignment="Left" VerticalAlignment="Center" TextWrapping="WrapWithOverflow"/>
                                    </DockPanel>
                                    <!--#endregion-->

                                </Grid>
                                <!--#endregion-->

                                <!--#region Управление бункером 2 -->
                                <Grid Grid.Column="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition></ColumnDefinition>
                                        <ColumnDefinition></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="0.5*"></RowDefinition>
                                        <RowDefinition></RowDefinition>
                                        <RowDefinition></RowDefinition>
                                        <RowDefinition></RowDefinition>
                                        <RowDefinition></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Label Grid.ColumnSpan="2" Content="Бункер 2" FontSize="20"  VerticalAlignment="Center" HorizontalAlignment="Center"></Label>
                                    <!--Кнопки открытия и закрытия бункера-->
                                    <!--#region Открыть бункер -->
                                    <Button Grid.Row="1" Template="{StaticResource UserButton}" DataContext="{Binding ButtonConfigs[24]}" Height="Auto" Visibility="{Binding ElementName=bunType2, Path=SelectedIndex, Converter={StaticResource unVisibleIfGreater}, ConverterParameter=2}" >
                                        <DockPanel>
                                            <Image Source="Pictures/open.png" Width="50"></Image>
                                            <TextBlock Text="{Binding Description}" TextWrapping="WrapWithOverflow" FontSize="20" VerticalAlignment="Center" HorizontalAlignment="Center"></TextBlock>
                                        </DockPanel>
                                    </Button>
                                    <!--#endregion-->

                                    <!--#region Закрыть бункер -->
                                    <Button Grid.Row="1" Grid.Column="1"  Template="{StaticResource UserButton}" DataContext="{Binding ButtonConfigs[25]}" Height="Auto" Visibility="{Binding ElementName=bunType2, Path=SelectedIndex, Converter={StaticResource unVisibleIfGreater}, ConverterParameter=2}" >
                                        <DockPanel>
                                            <Image Source="Pictures/close.png" Width="50"></Image>
                                            <TextBlock Text="{Binding Description}" TextWrapping="WrapWithOverflow" FontSize="20" VerticalAlignment="Center" HorizontalAlignment="Center"></TextBlock>
                                        </DockPanel>
                                    </Button>
                                    <!--#endregion-->



                                    <!--#region Индикатор "Бункер открывается" -->
                                    <DockPanel Grid.Row="3" DataContext="{Binding IndicatorConfigs[50]}" Visibility="{Binding ElementName=bunType2, Path=SelectedIndex, Converter={StaticResource unVisibleIfGreater}, ConverterParameter=2}" >
                                        <UserControl Template="{StaticResource StandIndicator}" Width="50"/>
                                        <TextBlock Text="{Binding Description}" Foreground="#DDD1C8C8"  FontSize="20" HorizontalAlignment="Left" VerticalAlignment="Center" TextWrapping="WrapWithOverflow"/>
                                    </DockPanel>
                                    <!--#endregion-->

                                    <!--#region Индикатор "Бункер закрывается" -->
                                    <DockPanel Grid.Row="4"  DataContext="{Binding IndicatorConfigs[52]}" Visibility="{Binding ElementName=bunType2, Path=SelectedIndex, Converter={StaticResource unVisibleIfGreater}, ConverterParameter=2}" >
                                        <UserControl Template="{StaticResource StandIndicator}" Width="50"/>
                                        <TextBlock Text="{Binding Description}" Foreground="#DDD1C8C8"  FontSize="20" HorizontalAlignment="Left" VerticalAlignment="Center" TextWrapping="WrapWithOverflow"/>
                                    </DockPanel>
                                    <!--#endregion-->

                                    <!--Ручное управление транспортером-->
                                    <!--#region Включить выключить траспортер -->
                                    <Button Grid.Row="1" Grid.ColumnSpan="2" Template="{StaticResource UserButton}" DataContext="{Binding ButtonConfigs[27]}" Height="Auto"
                                            Visibility="{Binding ElementName=bunType2, Path=SelectedIndex, Converter={StaticResource visibleIfEqual}, ConverterParameter=3}">
                                        <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="20" Text="{Binding Description}"></TextBlock>
                                    </Button>
                                    <!--#endregion-->

                                    <!--#region Индикатор двигателя конвейера -->
                                    <DockPanel Grid.Row="3" DataContext="{Binding IndicatorConfigs[54]}" Visibility="{Binding ElementName=bunType2, Path=SelectedIndex, Converter={StaticResource visibleIfEqual}, ConverterParameter=3}" >
                                        <UserControl Template="{StaticResource StandIndicator}" Width="50"/>
                                        <TextBlock Text="{Binding Description}" Foreground="#DDD1C8C8"  FontSize="20" HorizontalAlignment="Left" VerticalAlignment="Center" TextWrapping="WrapWithOverflow"/>
                                    </DockPanel>
                                    <!--#endregion-->



                                </Grid>
                                <!--#endregion-->
                            </Grid>
                            <!--#endregion-->

                            <!--#region Статусы и параметры -->
                            <DockPanel Grid.Column="1">
                                <!--#region Статусы бункера -->
                                <ListBox DockPanel.Dock="Top" Background="Gray" HorizontalAlignment="Stretch">
                                    <ListBox.Resources>
                                        <!--Статус бункера-->
                                        <col1:ArrayList x:Key="BunkerStatuses">
                                            <sys1:String>ОШИБКА ПРИ ОТКРЫТИИ БУНКЕРА</sys1:String>
                                            <sys1:String>ОШИБКА ПРИ ЗАКРЫТИИ БУНКЕРА</sys1:String>
                                            <sys1:String>БУНКЕР ОТКРЫТ</sys1:String>
                                            <sys1:String>БУНКЕР ЗАКРЫТ</sys1:String>
                                            <sys1:String>ОТКРЫТИЕ БУНКЕРА</sys1:String>
                                            <sys1:String>ЗАКРЫТИЕ БУНКЕРА</sys1:String>
                                            <sys1:String>ТРАНСПОРТЕР ОСТАНОВЛЕН</sys1:String>
                                            <sys1:String>ДВИЖЕНИЕ ТРАНСПОРТЕРА</sys1:String>
                                            <sys1:String>ОШИБКА ПРИВОДА ТРАНСПОРТЕРА</sys1:String>
                                        </col1:ArrayList>
                                    </ListBox.Resources>
                                    <!--#region  Статус бункера 1-->
                                    <ListBoxItem Template="{StaticResource TextIndicator}" DataContext="{Binding DataCells[75]}"  Content="{StaticResource BunkerStatuses}"
                                                 Style="{StaticResource VisibleBun1}"></ListBoxItem>
                                    <!--#endregion-->

                                    <!--#region Статус бункера 2 -->
                                    <ListBoxItem Template="{StaticResource TextIndicator}" DataContext="{Binding DataCells[76]}"  Content="{StaticResource BunkerStatuses}"
                                                 Style="{StaticResource VisibleBun2}"></ListBoxItem>
                                    <!--#endregion-->
                                </ListBox>
                                <!--#endregion-->

                                <!--#region Панель параметров бункера -->
                                <ListBox  FontFamily="Calibry" Foreground="#DDD1C8C8"  FontSize="20">
                                    <ListBox.Resources>
                                        <!--#region Стили, определяющие видимость параметров бункера только под администратором -->
                                        <!--#region Видимость параметров бункера 1 -->
                                        <Style TargetType="ListBoxItem"  x:Key="VisibleBunAdmin1">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <MultiDataTrigger>
                                                    <MultiDataTrigger.Conditions>
                                                        <Condition Binding ="{Binding RelativeSource={RelativeSource AncestorType=Window, Mode=FindAncestor}, Path=DataContext.CurrentUser.Level}" Value="Администратор"/>
                                                        <Condition Binding="{Binding ElementName=bunType1, Path=SelectedIndex, Converter={StaticResource isGreater}, ConverterParameter=0}" Value="True"/>
                                                        <Condition Binding="{Binding ElementName=bunType1, Path=SelectedIndex, Converter={StaticResource isLess}, ConverterParameter=3}" Value="True"/>
                                                    </MultiDataTrigger.Conditions>
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </MultiDataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                        <!--#endregion-->

                                        <!--#region Видимость параметров бункера 2 -->
                                        <Style TargetType="ListBoxItem"  x:Key="VisibleBunAdmin2">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <MultiDataTrigger>
                                                    <MultiDataTrigger.Conditions>
                                                        <Condition Binding ="{Binding RelativeSource={RelativeSource AncestorType=Window, Mode=FindAncestor}, Path=DataContext.CurrentUser.Level}" Value="Администратор"/>
                                                        <Condition Binding="{Binding ElementName=bunType2, Path=SelectedIndex, Converter={StaticResource isGreater}, ConverterParameter=0}" Value="True"/>
                                                        <Condition Binding="{Binding ElementName=bunType2, Path=SelectedIndex, Converter={StaticResource isLess}, ConverterParameter=3}" Value="True"/>
                                                    </MultiDataTrigger.Conditions>
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </MultiDataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                        <!--#endregion-->

                                        <!--#region Видимость параметров транспортера 1 -->
                                        <Style TargetType="Control"  x:Key="VisibleTranspAdmin1">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <MultiDataTrigger>
                                                    <MultiDataTrigger.Conditions>
                                                        <Condition Binding ="{Binding RelativeSource={RelativeSource AncestorType=Window, Mode=FindAncestor}, Path=DataContext.CurrentUser.Level}" Value="Администратор"/>
                                                        <Condition Binding="{Binding ElementName=bunType1, Path=SelectedIndex, Converter={StaticResource isEqual}, ConverterParameter=3}" Value="True"/>
                                                    </MultiDataTrigger.Conditions>
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </MultiDataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                        <!--#endregion-->

                                        <!--#region Видимость параметров транспортера 2 -->
                                        <Style TargetType="Control"  x:Key="VisibleTranspAdmin2">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <MultiDataTrigger>
                                                    <MultiDataTrigger.Conditions>
                                                        <Condition Binding ="{Binding RelativeSource={RelativeSource AncestorType=Window, Mode=FindAncestor}, Path=DataContext.CurrentUser.Level}" Value="Администратор"/>
                                                        <Condition Binding="{Binding ElementName=bunType2, Path=SelectedIndex, Converter={StaticResource isEqual}, ConverterParameter=3}" Value="True"/>
                                                    </MultiDataTrigger.Conditions>
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </MultiDataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                        <!--#endregion-->
                                        <!--#endregion-->
                                    </ListBox.Resources>

                                    <!--#region Количество проб в бункере 1 для автоматической выгрузки -->
                                    <ListBoxItem Template="{StaticResource ParamListBoxItem}" DataContext="{Binding DataCells[77]}" 
                                             Style="{StaticResource VisibleBun1}"></ListBoxItem>
                                    <!--#endregion-->

                                    <!--#region Количество проб в бункере 2 для автоматической выгрузки -->
                                    <ListBoxItem Template="{StaticResource ParamListBoxItem}" DataContext="{Binding DataCells[78]}" 
                                             Style="{StaticResource VisibleBun2}"></ListBoxItem>
                                    <!--#endregion-->

                                    <!--#region Текущее количество проб в бункере 1 -->
                                    <ListBoxItem Template="{StaticResource ParamListBoxItem}" DataContext="{Binding DataCells[79]}" 
                                             Style="{StaticResource VisibleBun1}"></ListBoxItem>
                                    <!--#endregion-->

                                    <!--#region Текущее количество проб в бункере 2 -->
                                    <ListBoxItem Template="{StaticResource ParamListBoxItem}" DataContext="{Binding DataCells[80]}" 
                                             Style="{StaticResource VisibleBun2}"></ListBoxItem>
                                    <!--#endregion-->

                                    <!--#region Обьем бункера 1 -->
                                    <ListBoxItem Template="{StaticResource ParamListBoxItem}" DataContext="{Binding DataCells[81]}" 
                                             Style="{StaticResource VisibleBunAdmin1}"></ListBoxItem>
                                    <!--#endregion-->

                                    <!--#region Обьем бункера 2 -->
                                    <ListBoxItem Template="{StaticResource ParamListBoxItem}" DataContext="{Binding DataCells[82]}" 
                                             Style="{StaticResource VisibleBunAdmin2}"></ListBoxItem>
                                    <!--#endregion-->

                                    <!--#region Время работы транспортера 1 после отбора пробы, с -->
                                    <ListBoxItem Template="{StaticResource ParamListBoxItem}" DataContext="{Binding DataCells[83]}" 
                                             Visibility="{Binding ElementName=bunType1, Path=SelectedIndex, Converter={StaticResource visibleIfEqual}, ConverterParameter=3}"></ListBoxItem>
                                    <!--#endregion-->

                                    <!--#region Время работы транспортера 2 после отбора пробы, с -->
                                    <ListBoxItem Template="{StaticResource ParamListBoxItem}" DataContext="{Binding DataCells[84]}" 
                                             Visibility="{Binding ElementName=bunType1, Path=SelectedIndex, Converter={StaticResource visibleIfEqual}, ConverterParameter=3}"></ListBoxItem>
                                    <!--#endregion-->

                                    <!--#region Возможность регулировать скорость транспортера 1 -->
                                    <ListBoxItem HorizontalContentAlignment="Stretch" DataContext="{Binding ButtonConfigs[28]}" Style="{StaticResource VisibleTranspAdmin1}" >
                                        <Grid>
                                            <TextBlock Text="{Binding Description}" ></TextBlock>
                                            <Button x:Name="ControlSpeedTransp1" Template="{StaticResource Switcher}"  HorizontalAlignment="Right"></Button>
                                        </Grid>
                                    </ListBoxItem>
                                    <!--#endregion-->

                                    <!--#region Возможность регулировать скорость транспортера 2 -->
                                    <ListBoxItem HorizontalContentAlignment="Stretch" DataContext="{Binding ButtonConfigs[29]}" Style="{StaticResource VisibleTranspAdmin2}" >
                                        <Grid>
                                            <TextBlock Text="{Binding Description}" ></TextBlock>
                                            <Button x:Name="ControlSpeedTransp2" Template="{StaticResource Switcher}"  HorizontalAlignment="Right"></Button>
                                        </Grid>
                                    </ListBoxItem>
                                    <!--#endregion-->

                                    <!--#region Скорость транспортера 1 -->
                                    <ListBoxItem DataContext="{Binding DataCells[85]}" Template="{StaticResource ParamListBoxItem}"
                                             Visibility="{Binding ElementName=ControlSpeedTransp1, Path=DataContext.BitValue, Converter={StaticResource BooleanToVisibilityConverter}}"></ListBoxItem>
                                    <!--#endregion-->

                                    <!--#region Скорость транспортера 2 -->
                                    <ListBoxItem DataContext="{Binding DataCells[86]}" Template="{StaticResource ParamListBoxItem}"
                                             Visibility="{Binding ElementName=ControlSpeedTransp2, Path=DataContext.BitValue, Converter={StaticResource BooleanToVisibilityConverter}}"></ListBoxItem>
                                    <!--#endregion-->



                                </ListBox>
                                <!--#endregion-->

                            </DockPanel>
                            <!--#endregion-->

                            <!--#region Визуализация бункера -->
                            <Viewbox Grid.Row="3"  Stretch="Uniform">
                                <StackPanel Orientation="Horizontal">
                                    <UserControl Template="{StaticResource bunkIndicator}" DataContext="{Binding DataCells[75]}"  Style="{StaticResource VisibleBun1}"></UserControl>
                                    <UserControl Template="{StaticResource bunkIndicator}" DataContext="{Binding DataCells[76]}" Style="{StaticResource VisibleBun2}"></UserControl>

                                </StackPanel>
                            </Viewbox>
                            <!--#endregion-->

                        </Grid>

                    </TabItem>
                    <!--#endregion-->

                    <!--#region Параметры дробилок -->
                    <TabItem Header="ДРОБИЛКИ" Visibility="{Binding ElementName=DrobEnable, Path=IsChecked, Converter={StaticResource visibleConverter}}"></TabItem>
                    <!--#endregion-->

                    <!--#region Параметры делителя -->
                    <TabItem Header="ДЕЛИТЕЛЬ" Tag="Pictures/delitel.png"  Visibility="{Binding ElementName=DelitelEnable, Path=IsChecked, Converter={StaticResource BooleanToVisibilityConverter}}">

                        <Grid>
                            <Grid.Resources>
                                <!--Изменение размеров столбцов в зависимости от количества делителей-->
                                <Style x:Key="column_1" TargetType="ColumnDefinition" >
                                    <Setter Property="Width" Value="*"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ElementName= DelType_1, Path=SelectedIndex}" Value="0">
                                            <Setter Property="Width" Value="0"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding ElementName= DelType_1, Path=SelectedIndex}" Value="3">
                                            <Setter Property="Width" Value="0"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                                <Style x:Key="column_2"  TargetType="ColumnDefinition">
                                    <Setter Property="Width" Value="*"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ElementName= DelType_2, Path=SelectedIndex}" Value="0">
                                            <Setter Property="Width" Value="0"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding ElementName= DelType_2, Path=SelectedIndex}" Value="3">
                                            <Setter Property="Width" Value="0"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                                <Style x:Key="column_3"  TargetType="ColumnDefinition">
                                    <Setter Property="Width" Value="*"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ElementName= DelType_3, Path=SelectedIndex}" Value="0">
                                            <Setter Property="Width" Value="0"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding ElementName= DelType_3, Path=SelectedIndex}" Value="3">
                                            <Setter Property="Width" Value="0"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                                <Style  x:Key="column_4"  TargetType="ColumnDefinition">
                                    <Setter Property="Width" Value="*"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ElementName= DelType_4, Path=SelectedIndex}" Value="0">
                                            <Setter Property="Width" Value="0"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding ElementName= DelType_4, Path=SelectedIndex}" Value="3">
                                            <Setter Property="Width" Value="0"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                                <!--Статус делителя-->
                                <col1:ArrayList x:Key="DelitelStatuses">
                                    <sys1:String>НЕОБХОДИМ ВОЗВРАТ КОВША</sys1:String>
                                    <sys1:String>ОШИБКА</sys1:String>
                                    <sys1:String>ГОТОВ К РАБОТЕ</sys1:String>
                                    <sys1:String>ПРОИЗВОДИТСЯ СОКРАЩЕНИЕ</sys1:String>
                                </col1:ArrayList>
                                <!--Cтиль для border-->
                                <Style TargetType="Border">
                                    <Setter Property="BorderBrush" Value="#DDD1C8C8"/>
                                    <Setter Property="BorderThickness" Value="1"/>
                                    <Setter Property="Background" Value="{Binding BitValue, Converter={StaticResource colorConv}}"></Setter>
                                </Style>

                            </Grid.Resources>
                            <Grid.ColumnDefinitions >
                                <ColumnDefinition></ColumnDefinition>
                                <ColumnDefinition></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition></RowDefinition>
                                <RowDefinition></RowDefinition>
                                <RowDefinition></RowDefinition>
                            </Grid.RowDefinitions>
                            
                            <!--#region Управление и индикация делителей -->
                            <Grid Grid.RowSpan="2">
                                
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Style="{StaticResource column_1}"></ColumnDefinition>
                                    <ColumnDefinition Style="{StaticResource column_2}" ></ColumnDefinition>
                                    <ColumnDefinition Style="{StaticResource column_3}" ></ColumnDefinition>
                                    <ColumnDefinition Style="{StaticResource column_4}" ></ColumnDefinition>

                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="0.3*"></RowDefinition>
                                    <RowDefinition Height="0.6*"></RowDefinition>
                                    <RowDefinition Height="0.6*"></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>                                    
                                </Grid.RowDefinitions>
                                <!--панель управления и индикации делителя 1-->
                                <!--#region панель управления и индикации делителя 1 -->
                                <Label FontSize="20" Foreground="#DDD1C8C8">Делитель 1</Label>
                                <!--Кнопка "Произвести сокращение-->
                                <Button Grid.Row="1" Template="{StaticResource UserButton}" DataContext="{Binding ButtonConfigs[14]}" Height="Auto">
                                    <TextBlock FontSize="14"  Text="{Binding Description}" TextWrapping="WrapWithOverflow" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                </Button>
                                <!--Кнопка "Возврат ковша"-->
                                <Button Grid.Row="2" Template="{StaticResource UserButton}" DataContext="{Binding ButtonConfigs[18]}" Height="Auto">
                                    <TextBlock FontSize="14"  Text="{Binding Description}" TextWrapping="WrapWithOverflow" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                </Button>
                               
                                <!--Индикатор датчика исходного положения ковща-->
                                <DockPanel Grid.Row="3" DataContext="{Binding IndicatorConfigs[33]}" >
                                    <UserControl Template="{StaticResource StandIndicator}" Width="50" ></UserControl>
                                    <TextBlock FontSize="14"  Text="{Binding Description}" TextWrapping="Wrap" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                </DockPanel>
                                <!--Индикация двигателя делителя-->
                                <Grid Grid.Row="4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition></ColumnDefinition>
                                        <ColumnDefinition></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="0.7*"></RowDefinition>
                                        <RowDefinition ></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Border Grid.ColumnSpan="2">
                                        <Label FontSize="16" Foreground="#DDD1C8C8"  HorizontalContentAlignment="Center">Вращение двигателя</Label>
                                    </Border>
                                    <Border Grid.Row="1" Grid.Column="0"  DataContext="{Binding IndicatorConfigs[41]}">
                                        <Label FontSize="16" Foreground="#DDD1C8C8" VerticalAlignment="Center"  HorizontalContentAlignment="Center">Вперед</Label>
                                        <Border.ToolTip>
                                            <ToolTip Content="{Binding Id}" Placement="Mouse"  ContentStringFormat="{}Индикатор {0}"></ToolTip>
                                        </Border.ToolTip>
                                    </Border>
                                    <Border Grid.Row="1" Grid.Column="1" DataContext="{Binding IndicatorConfigs[45]}">
                                        <Label FontSize="16" Foreground="#DDD1C8C8"  VerticalAlignment="Center"  HorizontalContentAlignment="Center">Назад</Label>
                                        <Border.ToolTip>
                                            <ToolTip Content="{Binding Id}" Placement="Mouse"  ContentStringFormat="{}Индикатор {0}"></ToolTip>
                                        </Border.ToolTip>
                                    </Border>
                                </Grid>

                                <!--Индикатор датчика рабочего положения ковща-->
                                <DockPanel Grid.Row="6" DataContext="{Binding IndicatorConfigs[37]}" Visibility="{Binding ElementName=DelType_1, Path=SelectedIndex, Converter={StaticResource visibleIfEqual}, ConverterParameter=2}" >
                                    <UserControl Template="{StaticResource StandIndicator}" Width="50" ></UserControl>
                                    <TextBlock FontSize="14"  Text="{Binding Description}" TextWrapping="Wrap" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                </DockPanel>

                                <!--#endregion-->

                                <!--#region панель управления и индикации делителя 2 -->
                                <Label FontSize="20" Grid.Column="1" Foreground="#DDD1C8C8">Делитель 2</Label>
                                <!--Кнопка "Произвести сокращение-->
                                <Button Grid.Row="1" Grid.Column="1" Template="{StaticResource UserButton}" DataContext="{Binding ButtonConfigs[15]}" Height="Auto">
                                    <TextBlock FontSize="14"  Text="{Binding Description}" TextWrapping="WrapWithOverflow" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                </Button>
                                <!--Кнопка "Возврат ковша"-->
                                <Button Grid.Row="2" Grid.Column="1" Template="{StaticResource UserButton}" DataContext="{Binding ButtonConfigs[19]}" Height="Auto">
                                    <TextBlock FontSize="14"  Text="{Binding Description}" TextWrapping="WrapWithOverflow" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                </Button>                                
                                <!--Индикатор датчика исходного положения ковща-->
                                <DockPanel Grid.Row="3" Grid.Column="1" DataContext="{Binding IndicatorConfigs[34]}" >
                                    <UserControl Template="{StaticResource StandIndicator}" Width="50" ></UserControl>
                                    <TextBlock FontSize="14"  Text="{Binding Description}" TextWrapping="Wrap" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                </DockPanel>
                                <!--Индикация двигателя делителя-->
                                <Grid Grid.Row="4" Grid.Column="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition></ColumnDefinition>
                                        <ColumnDefinition></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="0.7*"></RowDefinition>

                                        <RowDefinition ></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Border Grid.ColumnSpan="2">
                                        <Label FontSize="16" Foreground="#DDD1C8C8"  HorizontalContentAlignment="Center">Вращение двигателя</Label>
                                    </Border>
                                    <Border Grid.Row="1" Grid.Column="0"  DataContext="{Binding IndicatorConfigs[42]}">
                                        <Label FontSize="16" Foreground="#DDD1C8C8" VerticalAlignment="Center"  HorizontalContentAlignment="Center">Вперед</Label>
                                        <Border.ToolTip>
                                            <ToolTip Content="{Binding Id}" Placement="Mouse"  ContentStringFormat="{}Индикатор {0}"></ToolTip>
                                        </Border.ToolTip>
                                    </Border>
                                    <Border Grid.Row="1" Grid.Column="1" DataContext="{Binding IndicatorConfigs[46]}">
                                        <Label FontSize="16" Foreground="#DDD1C8C8"  VerticalAlignment="Center"  HorizontalContentAlignment="Center">Назад</Label>
                                        <Border.ToolTip>
                                            <ToolTip Content="{Binding Id}" Placement="Mouse"  ContentStringFormat="{}Индикатор {0}"></ToolTip>
                                        </Border.ToolTip>
                                    </Border>
                                </Grid>

                                <!--Индикатор датчика рабочего положения ковща-->
                                <DockPanel Grid.Row="6" Grid.Column="1"  DataContext="{Binding IndicatorConfigs[38]}" Visibility="{Binding ElementName=DelType_2, Path=SelectedIndex, Converter={StaticResource visibleIfEqual}, ConverterParameter=2}" >
                                    <UserControl Template="{StaticResource StandIndicator}" Width="50" ></UserControl>
                                    <TextBlock FontSize="14"  Text="{Binding Description}" TextWrapping="Wrap" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                </DockPanel>

                                <!--#endregion-->

                                <!--#region панель управления и индикации делителя 3 -->
                                <Label FontSize="20" Grid.Column="2" Foreground="#DDD1C8C8">Делитель 3</Label>
                                <!--Кнопка "Произвести сокращение-->
                                <Button Grid.Row="1" Grid.Column="2" Template="{StaticResource UserButton}" DataContext="{Binding ButtonConfigs[16]}" Height="Auto">
                                    <TextBlock FontSize="14"  Text="{Binding Description}" TextWrapping="WrapWithOverflow" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                </Button>
                                <!--Кнопка "Возврат ковша"-->
                                <Button Grid.Row="2" Grid.Column="2" Template="{StaticResource UserButton}" DataContext="{Binding ButtonConfigs[20]}" Height="Auto">
                                    <TextBlock FontSize="14"  Text="{Binding Description}" TextWrapping="WrapWithOverflow" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                </Button>
                                
                                <!--Индикатор датчика исходного положения ковща-->
                                <DockPanel Grid.Row="3" Grid.Column="2" DataContext="{Binding IndicatorConfigs[35]}" >
                                    <UserControl Template="{StaticResource StandIndicator}" Width="50" ></UserControl>
                                    <TextBlock FontSize="14"  Text="{Binding Description}" TextWrapping="Wrap" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                </DockPanel>
                                <!--Индикация двигателя делителя-->
                                <Grid Grid.Row="4" Grid.Column="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition></ColumnDefinition>
                                        <ColumnDefinition></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="0.7*"></RowDefinition>

                                        <RowDefinition ></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Border Grid.ColumnSpan="2">
                                        <Label FontSize="16" Foreground="#DDD1C8C8"  HorizontalContentAlignment="Center">Вращение двигателя</Label>
                                    </Border>
                                    <Border Grid.Row="1" Grid.Column="0"  DataContext="{Binding IndicatorConfigs[43]}">
                                        <Label FontSize="16" Foreground="#DDD1C8C8" VerticalAlignment="Center"  HorizontalContentAlignment="Center">Вперед</Label>
                                        <Border.ToolTip>
                                            <ToolTip Content="{Binding Id}" Placement="Mouse"  ContentStringFormat="{}Индикатор {0}"></ToolTip>
                                        </Border.ToolTip>
                                    </Border>
                                    <Border Grid.Row="1" Grid.Column="1" DataContext="{Binding IndicatorConfigs[47]}">
                                        <Label FontSize="16" Foreground="#DDD1C8C8"  VerticalAlignment="Center"  HorizontalContentAlignment="Center">Назад</Label>
                                        <Border.ToolTip>
                                            <ToolTip Content="{Binding Id}" Placement="Mouse"  ContentStringFormat="{}Индикатор {0}"></ToolTip>
                                        </Border.ToolTip>
                                    </Border>
                                </Grid>

                                <!--Индикатор датчика рабочего положения ковща-->
                                <DockPanel Grid.Row="6" Grid.Column="2"  DataContext="{Binding IndicatorConfigs[39]}" Visibility="{Binding ElementName=DelType_3, Path=SelectedIndex, Converter={StaticResource visibleIfEqual}, ConverterParameter=2}" >
                                    <UserControl Template="{StaticResource StandIndicator}" Width="50" ></UserControl>
                                    <TextBlock FontSize="14"  Text="{Binding Description}" TextWrapping="Wrap" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                </DockPanel>

                                <!--#endregion-->

                                <!--#region панель управления и индикации делителя 4 -->
                                <Label FontSize="20" Grid.Column="3" Foreground="#DDD1C8C8">Делитель 4</Label>
                                <!--Кнопка "Произвести сокращение-->
                                <Button Grid.Row="1" Grid.Column="3" Template="{StaticResource UserButton}" DataContext="{Binding ButtonConfigs[17]}" Height="Auto">
                                    <TextBlock FontSize="14"  Text="{Binding Description}" TextWrapping="WrapWithOverflow" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                </Button>
                                <!--Кнопка "Возврат ковша"-->
                                <Button Grid.Row="2" Grid.Column="3" Template="{StaticResource UserButton}" DataContext="{Binding ButtonConfigs[21]}" Height="Auto">
                                    <TextBlock FontSize="14"  Text="{Binding Description}" TextWrapping="WrapWithOverflow" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                </Button>                                
                                <!--Индикатор датчика исходного положения ковща-->
                                <DockPanel Grid.Row="3" Grid.Column="3" DataContext="{Binding IndicatorConfigs[36]}" >
                                    <UserControl Template="{StaticResource StandIndicator}" Width="50" ></UserControl>
                                    <TextBlock FontSize="14"  Text="{Binding Description}" TextWrapping="Wrap" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                </DockPanel>
                                <!--Индикация двигателя делителя-->
                                <Grid Grid.Row="4" Grid.Column="3">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition></ColumnDefinition>
                                        <ColumnDefinition></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="0.7*"></RowDefinition>

                                        <RowDefinition ></RowDefinition>
                                    </Grid.RowDefinitions>
                                    <Border Grid.ColumnSpan="2">
                                        <Label FontSize="16" Foreground="#DDD1C8C8"  HorizontalContentAlignment="Center">Вращение двигателя</Label>
                                    </Border>
                                    <Border Grid.Row="1" Grid.Column="0"  DataContext="{Binding IndicatorConfigs[44]}">
                                        <Label FontSize="16" Foreground="#DDD1C8C8" VerticalAlignment="Center"  HorizontalContentAlignment="Center">Вперед</Label>
                                        <Border.ToolTip>
                                            <ToolTip Content="{Binding Id}" Placement="Mouse"  ContentStringFormat="{}Индикатор {0}"></ToolTip>
                                        </Border.ToolTip>
                                    </Border>
                                    <Border Grid.Row="1" Grid.Column="1" DataContext="{Binding IndicatorConfigs[48]}">
                                        <Label FontSize="16" Foreground="#DDD1C8C8"  VerticalAlignment="Center"  HorizontalContentAlignment="Center">Назад</Label>
                                        <Border.ToolTip>
                                            <ToolTip Content="{Binding Id}" Placement="Mouse"  ContentStringFormat="{}Индикатор {0}"></ToolTip>
                                        </Border.ToolTip>
                                    </Border>
                                </Grid>

                                <!--Индикатор датчика рабочего положения ковща-->
                                <DockPanel Grid.Row="6" Grid.Column="3"  DataContext="{Binding IndicatorConfigs[40]}" Visibility="{Binding ElementName=DelType_4, Path=SelectedIndex, Converter={StaticResource visibleIfEqual}, ConverterParameter=2}" >
                                    <UserControl Template="{StaticResource StandIndicator}" Width="50" ></UserControl>
                                    <TextBlock FontSize="14"  Text="{Binding Description}" TextWrapping="Wrap" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                </DockPanel>

                                <!--#endregion-->

                            </Grid>
                            <!--#endregion-->

                            <!--#region Параметры и статусы -->
                            <DockPanel Grid.Column="1" Grid.RowSpan="2">
                                <!--#region Статусы делителей-->
                                <ListBox DockPanel.Dock="Top" Background="Gray">

                                    <!--#region Статус  делителя 1 -->
                                    <ListBoxItem Template="{StaticResource TextIndicator}" Content="{StaticResource DelitelStatuses}" DataContext="{Binding DataCells[64]}" 
                                     Style="{StaticResource VisibleDel1}"></ListBoxItem>
                                    <!--#endregion-->

                                    <!--#region Статус  делителя 2 -->
                                    <ListBoxItem Template="{StaticResource TextIndicator}" Content="{StaticResource DelitelStatuses}" DataContext="{Binding DataCells[65]}" 
                                     Style="{StaticResource VisibleDel2}"></ListBoxItem>
                                    <!--#endregion-->

                                    <!--#region Статус  делителя 3 -->
                                    <ListBoxItem Template="{StaticResource TextIndicator}" Content="{StaticResource DelitelStatuses}" DataContext="{Binding DataCells[66]}" 
                                     Style="{StaticResource VisibleDel3}"></ListBoxItem>
                                    <!--#endregion-->

                                    <!--#region Статус  делителя 4 -->
                                    <ListBoxItem Template="{StaticResource TextIndicator}" Content="{StaticResource DelitelStatuses}" DataContext="{Binding DataCells[67]}" 
                                     Style="{StaticResource VisibleDel4}"></ListBoxItem>
                                    <!--#endregion-->

                                </ListBox>
                                <!--#endregion-->

                                <!--#region Панель параметров делителя -->
                                <ListBox  FontFamily="Calibry" Foreground="#DDD1C8C8"  FontSize="20">
                                    <ListBoxItem Template="{StaticResource ParamListBoxItem}" DataContext="{Binding DataCells[68]}" Style="{StaticResource VisibleDel1}"></ListBoxItem>
                                    <ListBoxItem Template="{StaticResource ParamListBoxItem}" DataContext="{Binding DataCells[69]}" Style="{StaticResource VisibleDel2}"></ListBoxItem>
                                    <ListBoxItem Template="{StaticResource ParamListBoxItem}" DataContext="{Binding DataCells[70]}" Style="{StaticResource VisibleDel3}"></ListBoxItem>
                                    <ListBoxItem Template="{StaticResource ParamListBoxItem}" DataContext="{Binding DataCells[71]}" Style="{StaticResource VisibleDel4}"></ListBoxItem>
                                    <ListBoxItem Template="{StaticResource ParamListBoxItem}" DataContext="{Binding DataCells[72]}" Style="{StaticResource VisibleParam}"></ListBoxItem>
                                </ListBox>
                                <!--#endregion-->
                            </DockPanel>
                            <!--#endregion-->

                            <!--#region Визуализация делителя -->
                            <Viewbox Grid.Row="3"  Stretch="Uniform">
                                <StackPanel Orientation="Horizontal">
                                    <UserControl Template="{StaticResource DelIndicator}" DataContext="{Binding DataCells[64]}" Style="{StaticResource VisibleDel1}"></UserControl>
                                    <UserControl Template="{StaticResource DelIndicator}" DataContext="{Binding DataCells[65]}" Style="{StaticResource VisibleDel2}"></UserControl>
                                    <UserControl Template="{StaticResource DelIndicator}" DataContext="{Binding DataCells[66]}" Style="{StaticResource VisibleDel3}"></UserControl>
                                    <UserControl Template="{StaticResource DelIndicator}" DataContext="{Binding DataCells[67]}" Style="{StaticResource VisibleDel4}"></UserControl>
                                </StackPanel>
                            </Viewbox>
                            <!--#endregion-->

                        </Grid>
                    </TabItem>
                    <!--#endregion-->

                    <!--#region Параметры накопителя -->
                    <TabItem Header="НАКОПИТЕЛЬ" Tag="Pictures/nakop.png"  Visibility="{Binding ElementName=NakopitelEnable, Path=IsChecked, Converter={StaticResource visibleConverter}}" >
                        <Grid>
                            <Grid.Resources>
                                <col1:ArrayList x:Key="calibrationEnums">
                                    <sys1:String>КАЛИБРОВКА НЕ ВЫПОЛНЕНА</sys1:String>
                                    <sys1:String>ВЫПОЛНЯЕТСЯ КАЛИБРОВКА</sys1:String>
                                    <sys1:String>КАЛИБРОВКА ВЫПОЛНЕНА</sys1:String>
                                </col1:ArrayList>
                                <col1:ArrayList x:Key="changeCanistersEnums">
                                    <sys1:String>ГОТОВ К СМЕНЕ</sys1:String>
                                    <sys1:String>ВЫПОЛНЯЕТСЯ СМЕНА КАНИСТРЫ</sys1:String>
                                </col1:ArrayList>
                            </Grid.Resources>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition></ColumnDefinition>
                                <ColumnDefinition></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition></RowDefinition>
                                <RowDefinition></RowDefinition>
                            </Grid.RowDefinitions>                            

                            <!--#region Визуализация накопителя  -->
                            <ListBox  ItemContainerStyle="{DynamicResource ListBoxItemTemplate}"   Grid.Row="0" Grid.Column="0" Grid.RowSpan="2" Foreground="#DDD1C8C8" SelectionMode="Single" FontSize="20" SelectedIndex="{Binding DataCells[10].ParamValue, Converter={StaticResource FloatToIntConverter}}">
                                <ListBox.Resources>
                                    <ControlTemplate TargetType="UserControl" x:Key="ExistKanistra">
                                        <Image x:Name="ind"  Source="{StaticResource NotOk}" Height="35"></Image>
                                        <ControlTemplate.Triggers>
                                            <DataTrigger Binding="{Binding BitValue}" Value="True">
                                                <Setter  TargetName="ind" Property="Source" Value="{StaticResource Ok}"/>
                                            </DataTrigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                    <Style  TargetType="Label">
                                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                                        <Setter Property="Foreground" Value="#DDD1C8C8"/>
                                        <Setter Property="FontSize" Value="20"/>
                                    </Style>
                                    <Style x:Key="ListBoxItemTemplate" TargetType="ListBoxItem">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ListBoxItem">
                                                    <Border x:Name="border" Padding="2" SnapsToDevicePixels="True">
                                                        <ContentPresenter/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsSelected" Value="true">
                                                            <Setter TargetName="border" Property="Background" Value ="GreenYellow" />
                                                            <Setter Property="Foreground" Value="Red"/>

                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>


                                </ListBox.Resources>
                                <!--Заголовок-->
                                <ListBoxItem Visibility="{Binding DataCells[19].ParamValue, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource unVisibleIfLess}, ConverterParameter=1 }">
                                    <StackPanel Orientation="Horizontal" >
                                        <Border BorderBrush="#DDD1C8C8"  Width="50" BorderThickness="1" >
                                            <Label Content="№" ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <TextBlock Text="Наличие канистры" TextWrapping="Wrap" VerticalAlignment="Center" HorizontalAlignment="Center" ></TextBlock>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <TextBlock Text="Кол-во проб" TextWrapping="Wrap" VerticalAlignment="Center" HorizontalAlignment="Center" ></TextBlock>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="400" BorderThickness="1">
                                            <Label Content="Идентификатор партии"></Label>
                                        </Border>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--КАнистра 1-->
                                <ListBoxItem  Visibility="{Binding DataCells[19].ParamValue, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource unVisibleIfLess}, ConverterParameter=1 }">
                                    <StackPanel Orientation="Horizontal" >
                                        <Border BorderBrush="#DDD1C8C8"  Width="50" BorderThickness="1">
                                            <Label Content="1" ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <UserControl Template="{StaticResource ExistKanistra}" DataContext="{Binding IndicatorConfigs[10]}"></UserControl>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <Label Content="{Binding DataCells[26].ParamValue}"  ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="400" BorderThickness="1">
                                            <Label Content="{Binding DataCells[42].ParamValue}"></Label>
                                        </Border>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--Канистра 2-->
                                <ListBoxItem Visibility="{Binding DataCells[19].ParamValue, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource unVisibleIfLess}, ConverterParameter= 2 }">
                                    <StackPanel Orientation="Horizontal" >
                                        <Border BorderBrush="#DDD1C8C8"  Width="50" BorderThickness="1">
                                            <Label Content="2" ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <UserControl Template="{StaticResource ExistKanistra}" DataContext="{Binding IndicatorConfigs[11]}"></UserControl>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <Label Content="{Binding DataCells[27].ParamValue}"  ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="400" BorderThickness="1">
                                            <Label Content="{Binding DataCells[43].ParamValue}"></Label>
                                        </Border>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--Канистра 3-->
                                <ListBoxItem  Visibility="{Binding DataCells[19].ParamValue, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource unVisibleIfLess}, ConverterParameter=3 }">
                                    <StackPanel Orientation="Horizontal" >
                                        <Border BorderBrush="#DDD1C8C8"  Width="50" BorderThickness="1">
                                            <Label Content="3" ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <UserControl Template="{StaticResource ExistKanistra}" DataContext="{Binding IndicatorConfigs[12]}"></UserControl>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <Label Content="{Binding DataCells[28].ParamValue}"  ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="400" BorderThickness="1">
                                            <Label Content="{Binding DataCells[44].ParamValue}"></Label>
                                        </Border>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--Канистра 4-->
                                <ListBoxItem  Visibility="{Binding DataCells[19].ParamValue, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource unVisibleIfLess}, ConverterParameter=4 }">
                                    <StackPanel Orientation="Horizontal" >
                                        <Border BorderBrush="#DDD1C8C8"  Width="50" BorderThickness="1">
                                            <Label Content="4" ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <UserControl Template="{StaticResource ExistKanistra}" DataContext="{Binding IndicatorConfigs[13]}"></UserControl>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <Label Content="{Binding DataCells[29].ParamValue}"  ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="400" BorderThickness="1">
                                            <Label Content="{Binding DataCells[45].ParamValue}"></Label>
                                        </Border>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--Канистра 5-->
                                <ListBoxItem  Visibility="{Binding DataCells[19].ParamValue, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource unVisibleIfLess}, ConverterParameter=5 }">
                                    <StackPanel Orientation="Horizontal" >
                                        <Border BorderBrush="#DDD1C8C8"  Width="50" BorderThickness="1">
                                            <Label Content="5" ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <UserControl Template="{StaticResource ExistKanistra}" DataContext="{Binding IndicatorConfigs[14]}"></UserControl>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <Label Content="{Binding DataCells[30].ParamValue}"  ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="400" BorderThickness="1">
                                            <Label Content="{Binding DataCells[46].ParamValue}"></Label>
                                        </Border>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--Канистра 6-->
                                <ListBoxItem  Visibility="{Binding DataCells[19].ParamValue, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource unVisibleIfLess}, ConverterParameter=6 }">
                                    <StackPanel Orientation="Horizontal" >
                                        <Border BorderBrush="#DDD1C8C8"  Width="50" BorderThickness="1">
                                            <Label Content="6" ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <UserControl Template="{StaticResource ExistKanistra}" DataContext="{Binding IndicatorConfigs[15]}"></UserControl>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <Label Content="{Binding DataCells[31].ParamValue}"  ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="400" BorderThickness="1">
                                            <Label Content="{Binding DataCells[47].ParamValue}"></Label>
                                        </Border>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--Канистра 7-->
                                <ListBoxItem  Visibility="{Binding DataCells[19].ParamValue, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource unVisibleIfLess}, ConverterParameter=7 }">
                                    <StackPanel Orientation="Horizontal" >
                                        <Border BorderBrush="#DDD1C8C8"  Width="50" BorderThickness="1">
                                            <Label Content="7" ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <UserControl Template="{StaticResource ExistKanistra}" DataContext="{Binding IndicatorConfigs[16]}"></UserControl>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <Label Content="{Binding DataCells[32].ParamValue}"  ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="400" BorderThickness="1">
                                            <Label Content="{Binding DataCells[48].ParamValue}"></Label>
                                        </Border>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--Канистра 8-->
                                <ListBoxItem  Visibility="{Binding DataCells[19].ParamValue, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource unVisibleIfLess}, ConverterParameter=8 }">
                                    <StackPanel Orientation="Horizontal" >
                                        <Border BorderBrush="#DDD1C8C8"  Width="50" BorderThickness="1">
                                            <Label Content="8" ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <UserControl Template="{StaticResource ExistKanistra}" DataContext="{Binding IndicatorConfigs[17]}"></UserControl>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <Label Content="{Binding DataCells[33].ParamValue}"  ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="400" BorderThickness="1">
                                            <Label Content="{Binding DataCells[49].ParamValue}"></Label>
                                        </Border>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--Канистра 9-->
                                <ListBoxItem  Visibility="{Binding DataCells[19].ParamValue, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource unVisibleIfLess}, ConverterParameter=9 }">
                                    <StackPanel Orientation="Horizontal" >
                                        <Border BorderBrush="#DDD1C8C8"  Width="50" BorderThickness="1">
                                            <Label Content="9" ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <UserControl Template="{StaticResource ExistKanistra}" DataContext="{Binding IndicatorConfigs[18]}"></UserControl>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <Label Content="{Binding DataCells[34].ParamValue}"  ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="400" BorderThickness="1">
                                            <Label Content="{Binding DataCells[50].ParamValue}"></Label>
                                        </Border>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--Канистра 10-->
                                <ListBoxItem  Visibility="{Binding DataCells[19].ParamValue, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource unVisibleIfLess}, ConverterParameter=10 }">
                                    <StackPanel Orientation="Horizontal" >
                                        <Border BorderBrush="#DDD1C8C8"  Width="50" BorderThickness="1">
                                            <Label Content="10" ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <UserControl Template="{StaticResource ExistKanistra}" DataContext="{Binding IndicatorConfigs[19]}"></UserControl>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <Label Content="{Binding DataCells[35].ParamValue}"  ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="400" BorderThickness="1">
                                            <Label Content="{Binding DataCells[51].ParamValue}"></Label>
                                        </Border>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--Канистра 11-->
                                <ListBoxItem  Visibility="{Binding DataCells[19].ParamValue, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource unVisibleIfLess}, ConverterParameter=11 }">
                                    <StackPanel Orientation="Horizontal" >
                                        <Border BorderBrush="#DDD1C8C8"  Width="50" BorderThickness="1">
                                            <Label Content="11" ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <UserControl Template="{StaticResource ExistKanistra}" DataContext="{Binding IndicatorConfigs[20]}"></UserControl>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <Label Content="{Binding DataCells[36].ParamValue}"  ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="400" BorderThickness="1">
                                            <Label Content="{Binding DataCells[52].ParamValue}"></Label>
                                        </Border>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--Канистра 12-->
                                <ListBoxItem  Visibility="{Binding DataCells[19].ParamValue, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource unVisibleIfLess}, ConverterParameter=12 }">
                                    <StackPanel Orientation="Horizontal" >
                                        <Border BorderBrush="#DDD1C8C8"  Width="50" BorderThickness="1">
                                            <Label Content="12" ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <UserControl Template="{StaticResource ExistKanistra}" DataContext="{Binding IndicatorConfigs[21]}"></UserControl>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <Label Content="{Binding DataCells[37].ParamValue}"  ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="400" BorderThickness="1">
                                            <Label Content="{Binding DataCells[53].ParamValue}"></Label>
                                        </Border>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--Канистра 13-->
                                <ListBoxItem  Visibility="{Binding DataCells[19].ParamValue, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource unVisibleIfLess}, ConverterParameter=13 }">
                                    <StackPanel Orientation="Horizontal" >
                                        <Border BorderBrush="#DDD1C8C8"  Width="50" BorderThickness="1">
                                            <Label Content="13" ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <UserControl Template="{StaticResource ExistKanistra}" DataContext="{Binding IndicatorConfigs[22]}"></UserControl>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <Label Content="{Binding DataCells[38].ParamValue}"  ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="400" BorderThickness="1">
                                            <Label Content="{Binding DataCells[54].ParamValue}"></Label>
                                        </Border>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--Канистра 14-->
                                <ListBoxItem  Visibility="{Binding DataCells[19].ParamValue, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource unVisibleIfLess}, ConverterParameter=14 }">
                                    <StackPanel Orientation="Horizontal" >
                                        <Border BorderBrush="#DDD1C8C8"  Width="50" BorderThickness="1">
                                            <Label Content="14" ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <UserControl Template="{StaticResource ExistKanistra}" DataContext="{Binding IndicatorConfigs[23]}"></UserControl>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <Label Content="{Binding DataCells[39].ParamValue}"  ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="400" BorderThickness="1">
                                            <Label Content="{Binding DataCells[55].ParamValue}"></Label>
                                        </Border>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--Канистра 15-->
                                <ListBoxItem  Visibility="{Binding DataCells[19].ParamValue, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource unVisibleIfLess}, ConverterParameter=15 }">
                                    <StackPanel Orientation="Horizontal" >
                                        <Border BorderBrush="#DDD1C8C8"  Width="50" BorderThickness="1">
                                            <Label Content="15" ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <UserControl Template="{StaticResource ExistKanistra}" DataContext="{Binding IndicatorConfigs[24]}"></UserControl>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <Label Content="{Binding DataCells[40].ParamValue}"  ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="400" BorderThickness="1">
                                            <Label Content="{Binding DataCells[56].ParamValue}"></Label>
                                        </Border>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--Канистра 16-->
                                <ListBoxItem  Visibility="{Binding DataCells[19].ParamValue, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource unVisibleIfLess}, ConverterParameter=16 }">
                                    <StackPanel Orientation="Horizontal" >
                                        <Border BorderBrush="#DDD1C8C8"  Width="50" BorderThickness="1">
                                            <Label Content="16" ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <UserControl Template="{StaticResource ExistKanistra}" DataContext="{Binding IndicatorConfigs[25]}"></UserControl>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="100" BorderThickness="1">
                                            <Label Content="{Binding DataCells[41].ParamValue}"  ></Label>
                                        </Border>
                                        <Border BorderBrush="#DDD1C8C8" Width="400" BorderThickness="1">
                                            <Label Content="{Binding DataCells[57].ParamValue}"></Label>
                                        </Border>
                                    </StackPanel>
                                </ListBoxItem>
                            </ListBox>
                            <!--#endregion-->

                            <!--#region Управление и индикация накопителя -->
                            <Grid Grid.Row="0" Grid.Column="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition></ColumnDefinition>
                                    <ColumnDefinition></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                </Grid.RowDefinitions>
                                <!--Выполнить калибровку-->
                                <Button Template="{StaticResource UserButton}" Height="Auto" DataContext="{Binding ButtonConfigs[11] }">
                                    <Grid HorizontalAlignment="Stretch">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="0.3*"></ColumnDefinition>
                                            <ColumnDefinition Width="*"></ColumnDefinition>
                                        </Grid.ColumnDefinitions>
                                        <Image Source="Pictures/search.png"  HorizontalAlignment="Left" />
                                        <TextBlock Grid.Column="1" FontSize="14"  Text="{Binding Description}" TextWrapping="WrapWithOverflow" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                    </Grid>
                                </Button>
                                <!--Смена канистры-->
                                <Button Grid.Row="1" Template="{StaticResource UserButton}" Height="Auto" DataContext="{Binding ButtonConfigs[12] }">
                                    <Grid HorizontalAlignment="Stretch">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="0.3*"></ColumnDefinition>
                                            <ColumnDefinition Width="*"></ColumnDefinition>
                                        </Grid.ColumnDefinitions>
                                        <Image Source="Pictures/change.png"  HorizontalAlignment="Left" />
                                        <TextBlock Grid.Column="1" FontSize="14"  Text="{Binding Description}" TextWrapping="WrapWithOverflow" VerticalAlignment="Center"  Foreground="#DDD1C8C8"/>
                                    </Grid>
                                </Button>                                
                                <!--Датчики  накопителя-->
                                <StackPanel Grid.Row="2" Grid.Column="0" Grid.RowSpan="2">
                                    <StackPanel.Resources>
                                        <Style TargetType="Label">
                                            <Setter Property="Foreground" Value="#DDD1C8C8"/>
                                            <Setter Property="FontSize" Value="20"/>
                                            <Setter Property="VerticalAlignment" Value="Center"/>
                                            <Setter Property="Content" Value="{Binding Description}"/>
                                        </Style>
                                        <Style TargetType="UserControl">
                                            <Setter Property="Height" Value="50"/>
                                            <Setter Property="Template" Value="{StaticResource StandIndicator}"/>
                                            <Setter Property="DataContext" Value="{Binding}"/>
                                        </Style>
                                    </StackPanel.Resources>
                                    <!--Датчик двери накопителя-->
                                    <StackPanel Orientation="Horizontal" DataContext="{Binding IndicatorConfigs[26]}">
                                        <UserControl></UserControl>
                                        <Label></Label>
                                    </StackPanel>
                                    <!--Датчик полного оборота накопителя-->
                                    <StackPanel Orientation="Horizontal" DataContext="{Binding IndicatorConfigs[27]}">
                                        <UserControl></UserControl>
                                        <Label></Label>
                                    </StackPanel>
                                    <!--Датчик ячейки накопителя-->
                                    <StackPanel Orientation="Horizontal" DataContext="{Binding IndicatorConfigs[28]}">
                                        <UserControl></UserControl>
                                        <Label></Label>
                                    </StackPanel>
                                    <!--Датчик наличия канистры-->
                                    <StackPanel Orientation="Horizontal" DataContext="{Binding IndicatorConfigs[29]}">
                                        <UserControl></UserControl>
                                        <Label></Label>
                                    </StackPanel>
                                </StackPanel>
                                <!--Индикация работы двигателя накопителя-->
                                <StackPanel Grid.Row="2" Grid.Column="1" Grid.RowSpan="2">
                                    <StackPanel.Resources>
                                        <Style TargetType="Label">
                                            <Setter Property="Foreground" Value="#DDD1C8C8"/>
                                            <Setter Property="FontSize" Value="20"/>
                                            <Setter Property="VerticalAlignment" Value="Center"/>
                                            <Setter Property="Content" Value="{Binding Description}"/>
                                        </Style>
                                        <Style TargetType="UserControl">
                                            <Setter Property="Height" Value="50"/>
                                            <Setter Property="Template" Value="{StaticResource StandIndicator}"/>
                                            <Setter Property="DataContext" Value="{Binding}"/>
                                        </Style>
                                    </StackPanel.Resources>
                                    <!--Вращение вперед-->
                                    <StackPanel Orientation="Horizontal" DataContext="{Binding IndicatorConfigs[31]}">
                                        <UserControl></UserControl>
                                        <Label></Label>
                                    </StackPanel>
                                    <!--Вращение вперед-->
                                    <StackPanel Orientation="Horizontal" DataContext="{Binding IndicatorConfigs[32]}">
                                        <UserControl></UserControl>
                                        <Label></Label>
                                    </StackPanel>
                                </StackPanel>

                            </Grid>
                            <!--#endregion-->

                            <!--#region Параметры и статусы  -->
                            <DockPanel Grid.Row="1" Grid.Column="1">
                                <!--#region Статусы накопителя -->
                                <ListBox Background="Gray" DockPanel.Dock="Top">
                                    <!--#region Статус калибровки накопителя -->
                                    <ListBoxItem Template="{StaticResource TextIndicator}" DataContext="{Binding DataCells[58]}" Content="{StaticResource calibrationEnums}">
                                    </ListBoxItem>
                                    <!--#endregion-->

                                    <!--#region Статус смены канистры -->
                                    <ListBoxItem Template="{StaticResource TextIndicator}" DataContext="{Binding DataCells[59]}" Content="{StaticResource changeCanistersEnums}">
                                    </ListBoxItem>
                                    <!--#endregion-->                                  

                                </ListBox>
                                <!--#endregion-->

                                <!--#region Параметры накопителя -->
                                <ListBox  FontSize="20" Foreground="#DDD1C8C8">

                                    <!--#region Автоматическая калибровка накопителя -->
                                    <ListBoxItem HorizontalContentAlignment="Stretch" DataContext="{Binding ButtonConfigs[13]}" >
                                        <Grid>
                                            <TextBlock Text="{Binding Description}" ></TextBlock>
                                            <Button Template="{StaticResource Switcher}"  HorizontalAlignment="Right"></Button>
                                        </Grid>
                                    </ListBoxItem>
                                    <!--#endregion-->

                                </ListBox>
                                <!--#endregion-->
                            </DockPanel>
                            <!--#endregion-->

                        </Grid>
                    </TabItem>
                    <!--#endregion-->

                </TabControl>
            </TabItem>
            <!--#endregion-->

            <!--#region Страница "События" -->
            <TabItem Header="СОБЫТИЯ" Tag="Pictures/event.png" >                
                <TabControl TabStripPlacement="Top" Background="#FF363535" >
                    <!--Вкладка "События" на странице "События"-->
                    <TabItem Header="События">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"></RowDefinition>
                                <RowDefinition Height="0.06*"></RowDefinition>
                            </Grid.RowDefinitions>
                            <ListView Grid.Row="0" Name="historyError"  FontSize="16"   ItemsSource="{Binding FilteringEventCollection}" local:GridViewSort.AutoSort="True"   >
                                <ListView.ItemContainerStyle>
                                    <Style TargetType="{x:Type ListViewItem}">
                                        <Setter Property="Background" Value="LightSteelBlue"/>
                                        <Setter Property="Padding" Value="5"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=EventType}" Value="error">
                                                <Setter Property="Background" Value="Pink"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </ListView.ItemContainerStyle>
                                <ListView.View   >
                                    <GridView >
                                        <GridViewColumn  Width="200"  DisplayMemberBinding="{Binding Path=Date}" local:GridViewSort.PropertyName="Date">
                                            <GridViewColumn.Header>
                                                <TextBlock Text="Время возникновения" TextWrapping="WrapWithOverflow" Foreground="#DDD1C8C8"/>
                                            </GridViewColumn.Header>
                                        </GridViewColumn>
                                        <GridViewColumn  Width="300"  DisplayMemberBinding="{Binding Path=User}" local:GridViewSort.PropertyName="User">
                                            <GridViewColumn.Header>
                                                <TextBlock Text="Имя пользователя" TextWrapping="WrapWithOverflow" Foreground="#DDD1C8C8"/>
                                            </GridViewColumn.Header>
                                        </GridViewColumn>
                                        <GridViewColumn  Width="150"  DisplayMemberBinding="{Binding Path=EventCode}" local:GridViewSort.PropertyName="User">
                                            <GridViewColumn.Header>
                                                <TextBlock Text="Код события" TextWrapping="WrapWithOverflow" Foreground="#DDD1C8C8"/>
                                            </GridViewColumn.Header>
                                        </GridViewColumn>
                                        <GridViewColumn  Width="1000"  DisplayMemberBinding="{Binding Path=Message}" local:GridViewSort.PropertyName="Message">
                                            <GridViewColumn.Header>
                                                <TextBlock Text="Сообщение" TextWrapping="WrapWithOverflow" Foreground="#DDD1C8C8"/>
                                            </GridViewColumn.Header>
                                        </GridViewColumn>
                                        <GridViewColumn  Width="200"  DisplayMemberBinding="{Binding Path=EventType}" local:GridViewSort.PropertyName="EventType">
                                            <GridViewColumn.Header>
                                                <TextBlock Text="Тип события" TextWrapping="WrapWithOverflow" Foreground="#DDD1C8C8"/>
                                            </GridViewColumn.Header>
                                        </GridViewColumn>
                                    </GridView>
                                </ListView.View>
                            </ListView>
                            <DatePicker Style="{StaticResource MaterialDesignDatePicker}"  Foreground="White" Grid.Row="1" Text="{Binding FilterTextHistoryEvent, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="200" HorizontalAlignment="Left">
                               
                            </DatePicker>
                        </Grid>
                    </TabItem>
                    <!--Вкладка "Текущие ошибки" на странице "События"-->
                    <TabItem Header="Текущие ошибки">
                        <Grid>
                            <ListView Name="currentErrors" FontSize="16"  ItemsSource="{Binding EventConfigs, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" local:GridViewSort.AutoSort="True" >
                                <ListView.ItemContainerStyle>
                                    <Style TargetType="{x:Type ListViewItem}">
                                        <Setter Property="Background" Value="Pink"/>
                                        <Setter Property="Padding" Value="5"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=EventType}" Value="event">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Path=IsActive}" Value="false">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </ListView.ItemContainerStyle>
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn  Width="100"  DisplayMemberBinding="{Binding Path=Id}" local:GridViewSort.PropertyName="Id">
                                            <GridViewColumn.Header>
                                                <TextBlock Text="ID" TextWrapping="WrapWithOverflow" Foreground="#DDD1C8C8"/>
                                            </GridViewColumn.Header>
                                        </GridViewColumn>
                                        <GridViewColumn  Width="150"  DisplayMemberBinding="{Binding Path=EventCode}" local:GridViewSort.PropertyName="Id">
                                            <GridViewColumn.Header>
                                                <TextBlock Text="Код ошибки" TextWrapping="WrapWithOverflow" Foreground="#DDD1C8C8"/>
                                            </GridViewColumn.Header>
                                        </GridViewColumn>
                                        <GridViewColumn  Width="1000"  DisplayMemberBinding="{Binding Path=Description}" local:GridViewSort.PropertyName="Description">
                                            <GridViewColumn.Header>
                                                <TextBlock Text="События" TextWrapping="WrapWithOverflow" Foreground="#DDD1C8C8"/>
                                            </GridViewColumn.Header>
                                        </GridViewColumn>

                                    </GridView>
                                </ListView.View>
                            </ListView>
                        </Grid>
                    </TabItem>
                </TabControl>
            </TabItem>
            <!--#endregion-->

            <!--#region Страниица "Администрирование" -->
            <TabItem Header="Администрирование" Visibility="{Binding CurrentUser.Level, Converter={StaticResource visibleIfEqual}, ConverterParameter=Администратор}" >
                <TabControl TabStripPlacement="Left">
                    <!--Вкладка "Управление пользователями" на странице "Администрирование"-->
                    <TabItem Header="Пользователи">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"></RowDefinition>
                                <RowDefinition Height="0.075*"></RowDefinition>
                            </Grid.RowDefinitions>

                            <ListView FontSize="16" Name="userList" ItemsSource="{Binding Users}" >
                                <ListView.View>
                                    <GridView >
                                        <GridViewColumn  Width="200"  DisplayMemberBinding="{Binding Path=Login}">Логин</GridViewColumn>
                                        <GridViewColumn Width="200" DisplayMemberBinding="{Binding Path=Name}">Имя</GridViewColumn>
                                        <GridViewColumn Width="200" DisplayMemberBinding="{Binding Path=Somename}">Фамилия</GridViewColumn>
                                        <GridViewColumn Width="200" DisplayMemberBinding="{Binding Path=Post}">Должность</GridViewColumn>
                                        <GridViewColumn Width="200" DisplayMemberBinding="{Binding Path=Password}">Пароль</GridViewColumn>
                                        <GridViewColumn Width="200" DisplayMemberBinding="{Binding Path=Level}">Уровень доступа</GridViewColumn>
                                    </GridView>
                                </ListView.View>
                            </ListView>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Grid.Row="1">
                                <Button Content="Добавить" Margin="2" MinWidth="100" Command="{Binding AddUserCommand}"></Button>
                                <Button Content="Изменить" Margin="2" MinWidth="100" Command="{Binding EditUserCommand}"
                    CommandParameter="{Binding ElementName=userList, Path=SelectedItem}"  />
                                <Button Content="Удалить" Margin="2" MinWidth="100" Command="{Binding DeleteUserCommand}"
                    CommandParameter="{Binding ElementName=userList, Path=SelectedItem}"  />
                            </StackPanel>
                        </Grid>
                    </TabItem>
                    <!--Вкладка "Параметры" на странице "Администрирование"-->
                    <TabItem Header="Параметры">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="0.175*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <DataGrid x:Name="dataCells"   FontSize="16" AutoGenerateColumns="False" HorizontalGridLinesBrush="DarkGray" RowBackground="LightGray" 
                                      AlternatingRowBackground="White" ItemsSource="{Binding DataCells, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                      CanUserAddRows="False" CanUserDeleteRows="False">
                                <DataGrid.Resources>
                                    <col1:ArrayList x:Key="dataTypes">
                                        <sys1:String>short</sys1:String>
                                        <sys1:String>ushort</sys1:String>
                                        <sys1:String>int</sys1:String>
                                        <sys1:String>uint</sys1:String>
                                        <sys1:String>float</sys1:String>
                                        <sys1:String>string</sys1:String>
                                    </col1:ArrayList>
                                </DataGrid.Resources>
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Id"  Binding="{Binding Path=Id}" IsReadOnly="True"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Описание" Binding ="{Binding Path=Description}" MinWidth="450"></DataGridTextColumn>
                                    <DataGridComboBoxColumn Header ="Тип данных" ItemsSource="{StaticResource dataTypes}" SelectedItemBinding ="{Binding Path=DataType}"  ></DataGridComboBoxColumn>
                                    <DataGridTextColumn Header="Номер ДБ" Binding="{Binding Path=DbNum}"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Смещение(байт)" Width="100" Binding="{Binding Path=ByteOffset}"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Фактор" Binding="{Binding Path=Factor}"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Формат" Binding="{Binding Path=Format}"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Длина" Binding="{Binding Path=Length}"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Значение" Binding="{Binding Path=ParamValue}"></DataGridTextColumn>
                                    <DataGridComboBoxColumn Header ="Запись" ItemsSource="{StaticResource booleans}" SelectedItemBinding ="{Binding Path=WriteEnable}"></DataGridComboBoxColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            <ListBox Grid.Column="1">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Width="125" FontSize="16">Адрес ПЛК</TextBlock>
                                    <TextBox Width="100" FontSize="16" HorizontalContentAlignment="Center" Text="{Binding IpAdress, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"></TextBox>
                                </StackPanel>
                            </ListBox>
                        </Grid>
                    </TabItem>
                    <!--Вкладка "Индикаторы" на странице "Администрирование"-->
                    <TabItem Header="Индикаторы">
                        <Grid>
                            <DataGrid Name="indicators" FontSize="20" AutoGenerateColumns="False" HorizontalGridLinesBrush="DarkGray" RowBackground="LightGray" 
                                      AlternatingRowBackground="White" ItemsSource="{Binding IndicatorConfigs, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                      CanUserAddRows="False" CanUserDeleteRows="False">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Id" Binding="{Binding Id}"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Описание" Binding="{Binding Description}" Width="800"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Номер ДБ"  Binding="{Binding DbNum}"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Номер байта" Binding="{Binding ByteNum}"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Номер бита" Binding="{Binding BitNum}"></DataGridTextColumn>
                                    <DataGridComboBoxColumn Header="Инверсия" ItemsSource="{StaticResource booleans}" SelectedItemBinding ="{Binding Inverse}"></DataGridComboBoxColumn>
                                    <DataGridTextColumn Header="Значение" Binding="{Binding BitValue}"></DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                    <!--Вкладка "Кнопки" на странице "Администрирование"-->
                    <TabItem Header="Кнопки">
                        <Grid>
                            <DataGrid x:Name="buttons" FontSize="16" AutoGenerateColumns="False" HorizontalGridLinesBrush="DarkGray" RowBackground="LightGray" 
                                      AlternatingRowBackground="White" ItemsSource="{Binding ButtonConfigs, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                      CanUserAddRows="False" CanUserDeleteRows="False">
                                <DataGrid.Resources>
                                    <col1:ArrayList x:Key="buttonActions">
                                        <sys1:String>Мгновенно</sys1:String>
                                        <sys1:String>Переключатель</sys1:String>
                                        <sys1:String>Включить</sys1:String>
                                        <sys1:String>Выключить</sys1:String>
                                    </col1:ArrayList>
                                </DataGrid.Resources>
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Id" Binding="{Binding Id}"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Описание" Binding="{Binding Description}" Width="400"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Бит чтения - № ДБ" Binding="{Binding DbNum}"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Бит чтения - № байта" Binding="{Binding ByteNum}"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Бит чтения - № бита" Binding="{Binding BitNum}"></DataGridTextColumn>
                                    <DataGridComboBoxColumn Header="Бит чтения - № инверсия" ItemsSource="{StaticResource booleans}" SelectedItemBinding ="{Binding Inverse}"></DataGridComboBoxColumn>
                                    <DataGridTextColumn Header="Значение бита чтения" Binding="{Binding BitValue}"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Бит записи - № ДБ" Binding="{Binding DbNumWrite}"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Бит записи - № байта" Binding="{Binding ByteNumWrite}"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Бит записи - № бита" Binding="{Binding BitNumWrite}"></DataGridTextColumn>
                                    <DataGridComboBoxColumn Header="Действие" ItemsSource="{StaticResource buttonActions}" SelectedItemBinding="{Binding Action}"></DataGridComboBoxColumn>
                                    <DataGridTextColumn Header="Значение бита записи" Binding="{Binding BitValueWrite}"></DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                    
                    <!--#region Вкладка "События" на странице "Администрирование" -->
                    <TabItem Header="События">
                        <Grid>
                            <DataGrid  x:Name="eventConfigs"   FontSize="20" AutoGenerateColumns="False" HorizontalGridLinesBrush="DarkGray" RowBackground="LightGray" 
                                      AlternatingRowBackground="White" ItemsSource="{Binding EventConfigs, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                <DataGrid.Resources>
                                    <col1:ArrayList x:Key="eventTypes">
                                        <sys1:String>event</sys1:String>
                                        <sys1:String>error</sys1:String>
                                    </col1:ArrayList>
                                </DataGrid.Resources>
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Id" Binding ="{Binding Path=Id}" MinWidth="50"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Текст сообщения" Binding ="{Binding Path=Description}" MinWidth="600"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Номер ДБ" Binding ="{Binding Path=DbNum}" MinWidth="100"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Номер байта" Binding ="{Binding Path=ByteNum}" MinWidth="100"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Номер бита" Binding ="{Binding Path=BitNum}" MinWidth="100"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Значение бита" Binding ="{Binding Path=BitValue}" MinWidth="100"></DataGridTextColumn>
                                    <DataGridComboBoxColumn Header ="Тип события" ItemsSource="{StaticResource eventTypes}" SelectedItemBinding ="{Binding Path=EventType}"></DataGridComboBoxColumn>
                                    <DataGridTextColumn Header="Активность" Binding ="{Binding Path=IsActive}" MinWidth="100"></DataGridTextColumn>
                                    <DataGridTextColumn Header="Код события" Binding ="{Binding Path=EventCode}" MinWidth="100"></DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                    <!--#endregion-->

                    <TabItem Header="Статусы">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition></ColumnDefinition>
                                <ColumnDefinition></ColumnDefinition>
                                <ColumnDefinition></ColumnDefinition>
                                <ColumnDefinition></ColumnDefinition>
                                <ColumnDefinition></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            
                            <!--#region Статусы накопителя -->
                            <StackPanel Grid.Column="0">
                                <Label FontSize="16" Foreground="Black" HorizontalContentAlignment="Center">СТАТУСЫ НАКОПИТЕЛЯ</Label>
                                <DataGrid ItemsSource="{Binding NakopStatuses}" AutoGenerateColumns="False" >
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Индекс" Binding="{Binding Path=Id}" IsReadOnly="True"></DataGridTextColumn>
                                        <DataGridTextColumn Header="Текст" Binding="{Binding Path=Status}" ></DataGridTextColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                            <!--#endregion-->

                            <!--#region Статусы системы -->
                            <StackPanel Grid.Column="1">
                                <Label FontSize="16" Foreground="Black" HorizontalContentAlignment="Center">СТАТУСЫ СИСТЕМЫ</Label>
                                <DataGrid ItemsSource="{Binding SysStatuses}" AutoGenerateColumns="False" >
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Индекс" Binding="{Binding Path=Id}" IsReadOnly="True"></DataGridTextColumn>
                                        <DataGridTextColumn Header="Текст" Binding="{Binding Path=Status}" ></DataGridTextColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                            <!--#endregion-->

                            <!--#region Статусы проботборника -->
                            <StackPanel Grid.Column="2">
                                <Label FontSize="16" Foreground="Black" HorizontalContentAlignment="Center">СТАТУСЫ ПРОБООТБОРНИКА</Label>
                                <DataGrid ItemsSource="{Binding ProbStatuses}" AutoGenerateColumns="False" >
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Индекс" Binding="{Binding Path=Id}" IsReadOnly="True"></DataGridTextColumn>
                                        <DataGridTextColumn Header="Текст" Binding="{Binding Path=Status}" ></DataGridTextColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                            <!--#endregion-->

                            <!--#region Статусы бункера -->
                            <StackPanel Grid.Column="3">
                                <Label FontSize="16" Foreground="Black" HorizontalContentAlignment="Center">СТАТУСЫ БУНКЕРА</Label>
                                <DataGrid ItemsSource="{Binding BunStatuses}" AutoGenerateColumns="False" >
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Индекс" Binding="{Binding Path=Id}" IsReadOnly="True"></DataGridTextColumn>
                                        <DataGridTextColumn Header="Текст" Binding="{Binding Path=Status}" ></DataGridTextColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                            <!--#endregion-->

                            <!--#region Статусы делителя -->
                            <StackPanel Grid.Column="4">
                                <Label FontSize="16" Foreground="Black" HorizontalContentAlignment="Center">СТАТУСЫ ДЕЛИТЕЛЯ</Label>
                                <DataGrid ItemsSource="{Binding DelStatuses}" AutoGenerateColumns="False" >
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Индекс" Binding="{Binding Path=Id}" IsReadOnly="True"></DataGridTextColumn>
                                        <DataGridTextColumn Header="Текст" Binding="{Binding Path=Status}" ></DataGridTextColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                            <!--#endregion-->

                        </Grid>
                    </TabItem>

                    <!--#region Вкладка "Конфигурация" на странице "Администрирование" -->
                    <TabItem Header="Конфигурация">
                        <Grid Margin="5">
                            <ListBox FontSize="18" >
                                <ListBox.Resources>
                                    <!--Список типов пробоборника-->
                                    <col1:ArrayList x:Key="probTypes">
                                        <sys1:String>Не выбрано</sys1:String>
                                        <sys1:String>Пересечной</sys1:String>
                                        <sys1:String>Маятниковый</sys1:String>
                                        <sys1:String>Продольно-пересечной</sys1:String>
                                    </col1:ArrayList>
                                    <!--Список типов бункера-->
                                    <col1:ArrayList x:Key="BunkerTypes">
                                        <sys1:String>Не выбрано</sys1:String>
                                        <sys1:String>Пневмоцилиндр</sys1:String>
                                        <sys1:String>Двигатель</sys1:String>
                                        <sys1:String>Лента</sys1:String>
                                    </col1:ArrayList>
                                    <!--Список типов делителя-->
                                    <col1:ArrayList x:Key="DelitelTypes">
                                        <sys1:String>Модуль отсутствует</sys1:String>
                                        <sys1:String>Роторный</sys1:String>
                                        <sys1:String>Вторичный пересечной</sys1:String>
                                        <sys1:String>Вторичный маятниковый</sys1:String>
                                        <sys1:String>Делитель Джонсона</sys1:String>
                                    </col1:ArrayList>
                                </ListBox.Resources>
                                <!--#region Конфигурация пробоотборника -->
                                <ListBoxItem HorizontalAlignment="Stretch">
                                    <StackPanel Orientation="Horizontal">
                                        <!--Конфигурация проборника-->
                                        <Label Width="600" Foreground="Black">Проботборник</Label>
                                        <CheckBox  IsChecked="True" Width="50" Height="50" IsEnabled="False"></CheckBox>
                                        <StackPanel >
                                            <!--Количество проботборников-->
                                            <ListBoxItem  Template="{StaticResource ParamListBoxItemWhite}" DataContext="{Binding DataCells[13]}"  Width="700" ></ListBoxItem>
                                            <!--Тип проботборника-->
                                            <ComboBox Name="ProbType1" Template="{StaticResource ParamCompbobox}" DataContext="{Binding DataCells[25]}" ItemsSource="{StaticResource probTypes}"  Width="700" ></ComboBox>
                                        </StackPanel>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--#endregion-->

                                <!--#region Конфигурация бункера -->
                                <ListBoxItem>
                                    <ListBoxItem.Resources>
                                        <Style TargetType="CheckBox" BasedOn="{StaticResource MaterialDesignCheckBox}">

                                            <Style.Triggers>
                                                <MultiDataTrigger>
                                                    <MultiDataTrigger.Conditions>
                                                        <Condition Binding="{Binding ElementName=bunType1, Path= SelectedIndex}" Value="0"/>
                                                        <Condition Binding="{Binding ElementName=bunType2, Path= SelectedIndex}" Value="0"/>
                                                    </MultiDataTrigger.Conditions>
                                                    <Setter Property="IsChecked" Value="False"/>
                                                </MultiDataTrigger>
                                            </Style.Triggers>
                                            <Setter Property="IsChecked" Value="True"/>
                                        </Style>
                                    </ListBoxItem.Resources>
                                    <StackPanel Orientation="Horizontal">
                                        <Label Foreground="Black" Width="600">Бункер</Label>
                                        <CheckBox x:Name="BunkerEnable" Width="50" Height="50"></CheckBox>
                                        <StackPanel>
                                            <ComboBox Name="bunType1" SelectedIndex="{Binding ParamValue, Converter={StaticResource FloatToIntConverter}}" Template="{StaticResource ParamCompbobox}" DataContext="{Binding DataCells[73]}" ItemsSource="{StaticResource BunkerTypes}"  Width="700" ></ComboBox>
                                            <ComboBox Name="bunType2" SelectedIndex="{Binding ParamValue, Converter={StaticResource FloatToIntConverter}}" Template="{StaticResource ParamCompbobox}" DataContext="{Binding DataCells[74]}" ItemsSource="{StaticResource BunkerTypes}"  Width="700" ></ComboBox>
                                        </StackPanel>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--#endregion-->

                                <!--#region Конфигурация дробилок -->
                                <ListBoxItem>
                                    <StackPanel Orientation="Horizontal">
                                        <Label Width="600" Foreground="Black">Дробилки</Label>
                                        <CheckBox x:Name="DrobEnable"  IsChecked="{Binding ButtonConfigs[5].BitValue}" Width="50" Height="50">
                                            <i:Interaction.Triggers>
                                                <i:EventTrigger EventName="PreviewMouseLeftButtonDown">
                                                    <i:InvokeCommandAction  Command="{Binding ButtonPressOnCommand}" CommandParameter="{Binding ButtonConfigs[5]}"   />
                                                </i:EventTrigger>
                                                <i:EventTrigger EventName="Click" >
                                                    <i:InvokeCommandAction Command="{Binding ButtonPressOffCommand}" CommandParameter="{Binding ButtonConfigs[5]}" />
                                                </i:EventTrigger>
                                            </i:Interaction.Triggers>
                                        </CheckBox>
                                        <ListBoxItem Template="{StaticResource ParamListBoxItemWhite}" DataContext="{Binding DataCells[14]}"  Width="700" Visibility="{Binding ElementName=DrobEnable,Path=IsChecked, Converter={StaticResource visibleConverter}}"></ListBoxItem>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--#endregion-->

                                <!--#region Конфигурация делителей -->
                                <ListBoxItem>
                                    <ListBoxItem.Resources>
                                        <!--Условие галочки чекбокса "DelitelEnable"-->
                                        <Style TargetType="CheckBox" BasedOn="{StaticResource MaterialDesignCheckBox}">
                                            <Style.Triggers>
                                                <DataTrigger  Binding="{Binding ElementName=DelType_1, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Path = SelectedIndex}" Value="1">
                                                    <Setter   Property="IsChecked" Value="True"/>
                                                </DataTrigger>
                                                <DataTrigger  Binding="{Binding ElementName=DelType_1, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Path = SelectedIndex}" Value="2">
                                                    <Setter   Property="IsChecked" Value="True"/>                                                    
                                                </DataTrigger>
                                                <DataTrigger  Binding="{Binding ElementName=DelType_1, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Path = SelectedIndex}" Value="3">
                                                    <Setter   Property="IsChecked" Value="True"/>
                                                </DataTrigger>
                                                <DataTrigger  Binding="{Binding ElementName=DelType_2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Path = SelectedIndex}" Value="1">
                                                    <Setter   Property="IsChecked" Value="True"/>
                                                </DataTrigger>
                                                <DataTrigger  Binding="{Binding ElementName=DelType_2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Path = SelectedIndex}" Value="2">
                                                    <Setter   Property="IsChecked" Value="True"/>
                                                </DataTrigger>
                                                <DataTrigger  Binding="{Binding ElementName=DelType_2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Path = SelectedIndex}" Value="3">
                                                    <Setter   Property="IsChecked" Value="True"/>
                                                </DataTrigger>
                                                <DataTrigger  Binding="{Binding ElementName=DelType_3, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Path = SelectedIndex}" Value="1">
                                                    <Setter   Property="IsChecked" Value="True"/>
                                                </DataTrigger>
                                                <DataTrigger  Binding="{Binding ElementName=DelType_3, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Path = SelectedIndex}" Value="2">
                                                    <Setter   Property="IsChecked" Value="True"/>
                                                </DataTrigger>
                                                <DataTrigger  Binding="{Binding ElementName=DelType_3, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Path = SelectedIndex}" Value="3">
                                                    <Setter   Property="IsChecked" Value="True"/>
                                                </DataTrigger>
                                                <DataTrigger  Binding="{Binding ElementName=DelType_4, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Path = SelectedIndex}" Value="1">
                                                    <Setter   Property="IsChecked" Value="True"/>
                                                </DataTrigger>
                                                <DataTrigger  Binding="{Binding ElementName=DelType_4, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Path = SelectedIndex}" Value="2">
                                                    <Setter   Property="IsChecked" Value="True"/>
                                                </DataTrigger>
                                                <DataTrigger  Binding="{Binding ElementName=DelType_4, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Path = SelectedIndex}" Value="3">
                                                    <Setter   Property="IsChecked" Value="True"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </ListBoxItem.Resources>
                                    <StackPanel Orientation="Horizontal">

                                        <Label Width="600" Foreground="Black">Делитель</Label>
                                        <CheckBox Name="DelitelEnable"   Width="50" Height="50">
                                        </CheckBox>
                                        <StackPanel>
                                            <ComboBox Name="DelType_1" SelectedIndex="{Binding ParamValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource FloatToIntConverter}}" Template="{StaticResource ParamCompbobox}"   DataContext="{Binding DataCells[60]}" ItemsSource="{StaticResource DelitelTypes}" Width="700"></ComboBox>
                                            <ComboBox Name="DelType_2" SelectedIndex="{Binding ParamValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource FloatToIntConverter}}" Template="{StaticResource ParamCompbobox}" DataContext="{Binding DataCells[61]}" ItemsSource="{StaticResource DelitelTypes}" Width="700"></ComboBox>
                                            <ComboBox Name="DelType_3" SelectedIndex="{Binding ParamValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource FloatToIntConverter}}" Template="{StaticResource ParamCompbobox}" DataContext="{Binding DataCells[62]}" ItemsSource="{StaticResource DelitelTypes}" Width="700"></ComboBox>
                                            <ComboBox Name="DelType_4" SelectedIndex="{Binding ParamValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource FloatToIntConverter}}" Template="{StaticResource ParamCompbobox}" DataContext="{Binding DataCells[63]}" ItemsSource="{StaticResource DelitelTypes}" Width="700"></ComboBox>

                                        </StackPanel>

                                    </StackPanel>
                                </ListBoxItem>
                                <!--#endregion-->

                                <!--#region Конфигурация накопителя -->
                                <ListBoxItem>
                                    <StackPanel Orientation="Horizontal">
                                        <Label Width="600" Foreground="Black">Накопитель</Label>
                                        <CheckBox x:Name="NakopitelEnable"   IsChecked="{Binding ElementName=KaniterCount, Path=DataContext.ParamValue, Converter={StaticResource isGreater}, ConverterParameter=1}" Width="50" Height="50">                                         
                                        </CheckBox>
                                        <ListBoxItem x:Name="KaniterCount" DataContext="{Binding DataCells[19]}" Template="{StaticResource ParamListBoxItemWhite}" Width="700"></ListBoxItem>
                                    </StackPanel>
                                </ListBoxItem>
                                <!--#endregion-->
                            </ListBox>
                        </Grid>
                    </TabItem>
                    <!--#endregion-->
                </TabControl>
            </TabItem>
            <!--#endregion-->
            
        </TabControl>
        <!--#endregion-->
    </DockPanel>

</Window>
